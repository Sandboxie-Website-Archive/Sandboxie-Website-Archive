<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-gb">
	<link rel="self" type="application/atom+xml" href="https://forums.sandboxie.com/phpBB3/app.php/feed/topic/22829" />

	<title>Sandboxie Support</title>
	<subtitle>Support Forum for Sandboxie</subtitle>
	<link href="https://forums.sandboxie.com/phpBB3/index.php" />
	<updated>2016-08-08T03:03:07-04:00</updated>

	<author><name><![CDATA[Sandboxie Support]]></name></author>
	<id>https://forums.sandboxie.com/phpBB3/app.php/feed/topic/22829</id>

		<entry>
		<author><name><![CDATA[Syrinx]]></name></author>
		<updated>2016-08-08T03:03:07-04:00</updated>

		<published>2016-08-08T03:03:07-04:00</published>
		<id>https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=122570#p122570</id>
		<link href="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=122570#p122570"/>
		<title type="html"><![CDATA[Re: Office 2013 non C2R &amp; Excel work around.]]></title>

		
		<content type="html" xml:base="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=122570#p122570"><![CDATA[
Here's another minor update to the last bat. This version hasn't been extensively tested but there wasn't really anything major so here it is anyhow:<br><blockquote class="uncited"><div>1) Corrected parenthesis sets which weren't closed properly. [hopefully got em all...no, not the pokemon!]<br><br>2) Added a few extra escape [^] characters around misc 'text' [ECHO/Title] related stuff. These shouldn't have bothered anything but I changed it just to be 'correct' anyway and to help me identify things in a search.<br><br>3) Altered a few lines around :END regarding the %DONE%==0 checks. [Same result, slightly different display order]<br><br>4) Altered a few lines regarding CAPITALization that I missed before to make it easier for me to identify commands verses paths, exes and other stuff. Once again nothing that should change anything.<br><br>5) Added more Access Denied checks.<br><br>6) Renamed a couple areas.<br><br>7) Created a few new variables for 'Round checks' to make it easier for me to update a single number and then have others updated.<br><br>8) Added another background Round to check for a scenario this bat cannot currently fix in the exported '.reg's and it now shows alert text if it is found.<br>    It will continue to fix all others regardless.<br><br>9) Other drunken changes I don't recall...(Trust inspiring, eh?)</div></blockquote><div class="codebox"><p>CODE: </p><pre><code>@ECHO OFFTITLE EULA: Don^'t blame me!SET DONE=0IF EXIST "%~DP0Office\EULA.txt" GOTO INITIF EXIST "%~DP0\EULA.txt" GOTO INIT:PROMPTECHO This bat will modify your registry! [Office Related]ECHO.ECHO This bat was made by a user in an effort to aid other users.ECHO.ECHO The author does NOT make any warranty of any kind,ECHO either express or implied. In no event shall the author of thisECHO bat be liable for any consequential, direct, incidentalECHO or indirect damages ^(including, without limitation,ECHO damages for loss of business profits, business interruption,ECHO loss of business information, destruction of the universeECHO or any other loss^) arising from the use of this bat.ECHO.ECHO Do you agree to these terms?ECHO ^(Y for Yes, N for No^)ECHO.SET /P CHOICE=    ^   Make your Choice: SET CHOICE=%CHOICE:~0,1%IF /I "%CHOICE%"=="Y" GOTO INITIF /I "%CHOICE%"=="N" EXITCLSECHO Oops, please try again!ECHO.GOTO PROMPT:INITCLSECHO Checking Access Level...reg QUERY "HKEY_USERS\S-1-5-18" 1&gt;NUL 2&gt;NULIF %ERRORLEVEL%==5 GOTO SECURITYIF EXIST %WINDIR%\AdminTest RMDIR %WINDIR%\AdminTest  /Q /S 1&gt;NUL 2&gt;NULIF NOT EXIST %WINDIR%\AdminTest MD %WINDIR%\AdminTest 1&gt;NUL 2&gt;NULIF %ERRORLEVEL%==0 (IF EXIST %WINDIR%\AdminTest RMDIR %WINDIR%\AdminTest  /Q /S 1&gt;NUL 2&gt;NULECHO Seems to be running as Admin, continuing...GOTO SELECTION)ECHO.ECHO Sorry, it won't work if you don't ^(Right click the bat and^)ECHO Run as administratorGOTO END:SELECTIONSET /A "ROUNDNORM=6"SET /A "ROUNDLAST=%ROUNDNORM%+1"SET /A "ROUNDREST=%ROUNDNORM%+2"SET /A "ROUNDERR=%ROUNDNORM%+3"TITLE What are you doing?ECHO.ECHO **This bat will modify Office related registry entries!**ECHO.ECHO Choose 1 to Backup and Replace /ddeECHO Choose 2 to Restore /dde using BackupsECHO Choose 3 to Cancel and Exit.ECHO.ECHO **This bat will modify Office related registry entries!**ECHO.SET /P SELECTION=    ^   Which option number would you like to try?: SET SELECTION=%SELECTION:~0,1%IF /I "%SELECTION%"=="1" GOTO ROUND_1IF /I "%SELECTION%"=="2" GOTO ROUND_%ROUNDREST%IF /I "%SELECTION%"=="3" EXITCLSECHO Oops, please try again!ECHO.GOTO SELECTION:CYCLEIF %NUMBER%==1 SET CURRENTTARGET=Excel.BackupIF %NUMBER%==2 SET CURRENTTARGET=Excel.ChartIF %NUMBER%==3 SET CURRENTTARGET=Excel.CSVIF %NUMBER%==4 SET CURRENTTARGET=Excel.MacrosheetIF %NUMBER%==5 SET CURRENTTARGET=Excel.OpenDocumentSpreadsheet.12IF %NUMBER%==6 SET CURRENTTARGET=Excel.Sheet.12IF %NUMBER%==7 SET CURRENTTARGET=Excel.Sheet.8IF %NUMBER%==8 SET CURRENTTARGET=Excel.SheetBinaryMacroEnabled.12IF %NUMBER%==9 SET CURRENTTARGET=Excel.SheetMacroEnabled.12IF %NUMBER%==10 SET CURRENTTARGET=Excel.TemplateIF %NUMBER%==11 SET CURRENTTARGET=Excel.Template.8IF %NUMBER%==12 SET CURRENTTARGET=Excel.TemplateMacroEnabledIF %NUMBER%==13 SET CURRENTTARGET=Word.Backup.8IF %NUMBER%==14 SET CURRENTTARGET=Word.Document.12IF %NUMBER%==15 SET CURRENTTARGET=Word.Document.8IF %NUMBER%==16 SET CURRENTTARGET=Word.DocumentMacroEnabled.12IF %NUMBER%==17 SET CURRENTTARGET=Word.DocumentMacroEnabled.8IF %NUMBER%==18 SET CURRENTTARGET=Word.RTF.8IF %NUMBER%==19 SET CURRENTTARGET=Word.Template.12IF %NUMBER%==20 SET CURRENTTARGET=Word.Template.8IF %NUMBER%==21 SET CURRENTTARGET=Word.TemplateMacroEnabled.12IF %NUMBER%==22 SET CURRENTTARGET=Word.TemplateMacroEnabled.8IF %NUMBER% GEQ 23 GOTO CHECKROUNDSET /A NUMBER=NUMBER+1IF DEFINED AUTORESTORE GOTO RESTOREGOTO FILES:FILESSET /A ROUNDPREV=%ROUNDNUM%-1reg QUERY "HKEY_CLASSES_ROOT\%CURRENTTARGET%\shell\Print\ddeexec" 1&gt;NUL 2&gt;NULIF %ERRORLEVEL%==5 GOTO SECURITYIF %ERRORLEVEL%==1 GOTO CYCLEIF NOT EXIST "%~DP0Office\%CURRENTTARGET%.reg" regedit /A "%~DP0Office\%CURRENTTARGET%.reg" "HKEY_CLASSES_ROOT\%CURRENTTARGET%\shell"IF %ERRORLEVEL%==5 GOTO SECURITYIF NOT EXIST "%~DP0Office\%CURRENTTARGET%.reg" GOTO CYCLEIF %ROUNDNUM%==1 (IF EXIST "%~DP0Office\%CURRENTTARGET%.reg" (SET "SOURCE=%~DP0Office\%CURRENTTARGET%.reg"SET "TARGET=%~DP0Office\Temp\%CURRENTTARGET%.Fixing.%ROUNDNUM%.reg"GOTO REPLACE))IF NOT EXIST "%~DP0Office\Temp\%CURRENTTARGET%.Fixing.%ROUNDPREV%.reg" GOTO CYCLESET "SOURCE=%~DP0Office\Temp\%CURRENTTARGET%.Fixing.%ROUNDPREV%.reg"IF %ROUNDNUM% LEQ %ROUNDNORM% (SET "TARGET=%~DP0Office\Temp\%CURRENTTARGET%.Fixing.%ROUNDNUM%.reg"IF %DONOTFIX% EQU 1 GOTO CHECKREGGOTO REPLACE)IF %ROUNDNUM% EQU %ROUNDLAST% (SET "TARGET=%~DP0Office\Fix\%CURRENTTARGET%.Fixed.reg"GOTO REPLACE)GOTO CYCLE:CHECKROUNDSET /A ROUNDNUM=ROUNDNUM+1IF %ROUNDNUM% LEQ %ROUNDLAST% (SET /A NUMBER=1GOTO Round_%ROUNDNUM%)IF %ROUNDNUM% GEQ %ROUNDREST% (IF %ROUNDNUM% LEQ %ROUNDERR% GOTO END)GOTO ERROR:REPLACESETLOCAL ENABLEDELAYEDEXPANSION(FOR /F "tokens=1* delims=:" %%A IN ('findstr /N "^" "%SOURCE%"') DO (SET "LINE=%%B"IF DEFINED LINE SET "LINE=!LINE:%ORIGINAL%=%FIX%!"ECHO(!LINE!)) &gt; "%TARGET%")ENDLOCALIF EXIST "%~DP0Office\Fix\%CURRENTTARGET%.Fixed.reg" (regedit /S "%~DP0Office\Fix\%CURRENTTARGET%.Fixed.reg"reg DELETE HKEY_CLASSES_ROOT\%CURRENTTARGET%\shell\Edit\ddeexec /f 1&gt;NUL 2&gt;NULreg DELETE HKEY_CLASSES_ROOT\%CURRENTTARGET%\shell\New\ddeexec /f 1&gt;NUL 2&gt;NULreg DELETE HKEY_CLASSES_ROOT\%CURRENTTARGET%\shell\OnenotePrintto\ddeexec /f 1&gt;NUL 2&gt;NULreg DELETE HKEY_CLASSES_ROOT\%CURRENTTARGET%\shell\Open\ddeexec /f 1&gt;NUL 2&gt;NULreg DELETE HKEY_CLASSES_ROOT\%CURRENTTARGET%\shell\OpenAsReadOnly\ddeexec /f 1&gt;NUL 2&gt;NULreg DELETE HKEY_CLASSES_ROOT\%CURRENTTARGET%\shell\Print\ddeexec /f 1&gt;NUL 2&gt;NULreg DELETE HKEY_CLASSES_ROOT\%CURRENTTARGET%\shell\Printto\ddeexec /f 1&gt;NUL 2&gt;NULreg DELETE HKEY_CLASSES_ROOT\%CURRENTTARGET%\shell\ViewProtected\ddeexec /f 1&gt;NUL 2&gt;NULSET /A DONE=DONE+1)GOTO CYCLE:CHECKREGfindstr /C:"  64,64,65,00,00" "%SOURCE%" 1&gt;NUL 2&gt;NULIF NOT ERRORLEVEL==1 (ECHO.ECHO *****************************************************************************ECHO ***ALERT*ALERT*ALERT*ALERT*ALERT*ALERT*ALERT*ALERT*ALERT*ALERT*ALERT*ALERT***ECHO.ECHO   %CURRENTTARGET% contains an entry the bat does not alter!ECHO   %CURRENTTARGET% may still result in the same command error as before.ECHO *****************************************************************************)COPY /Y "%SOURCE%" "%TARGET%" 1&gt;NUL 2&gt;NULGOTO CYCLE:ROUND_1TITLE Replace /ddeCLSECHO.ECHO Starting Pass 1 ^(This should be quick^)IF NOT EXIST "%~DP0Office" MD "%~DP0Office" 1&gt;NULIF NOT EXIST "%~DP0Office\Fix" MD "%~DP0Office\Fix" 1&gt;NULIF NOT EXIST "%~DP0Office\Temp" MD "%~DP0Office\Temp" 1&gt;NULIF NOT EXIST "%~DP0Office\EULA.txt" (IF NOT EXIST "%~DP0\EULA.txt" (TYPE NUL &gt; "%~DP0Office\EULA.txt"))SET /A DONOTFIX=0SET /A ROUNDNUM=1SET /A NUMBER=1SET "ORIGINAL= /dde"SET "FIX= \"%%1\""GOTO CYCLE:ROUND_2SET /A DONOTFIX=1GOTO CYCLE:ROUND_3ECHO.ECHO Starting Pass 2 ^(This may take a bit^)COPY /Y "%~0" "%~DP0Office\BACKUP.bat" 1&gt;NUL 2&gt;NULSET /A DONOTFIX=0SET "ORIGINAL=2f,64,64,65"SET "FIX=22,25,31,22"GOTO CYCLE:ROUND_4ECHO .SET "ORIGINAL=2f,64,64"SET "FIX=22,25,31"GOTO CYCLE:ROUND_5ECHO ..SET "ORIGINAL=  65,00,00"SET "FIX=  22,00,00"GOTO CYCLE:ROUND_6ECHO ...SET "ORIGINAL=2f,64"SET "FIX=22,25"GOTO CYCLE:ROUND_7ECHO ....SET "ORIGINAL=  64,65,00,00"SET "FIX=  31,22,00,00"GOTO CYCLE:ROUND_8CLSECHO.ECHO Attempting to restore Original registry backups.SET AUTORESTORE=1SET /A ROUNDNUM=7SET /A NUMBER=1GOTO CYCLE:RESTOREIF EXIST "%~DP0Office\%CURRENTTARGET%.reg" (regedit /S "%~DP0Office\%CURRENTTARGET%.reg"SET /A DONE=DONE+1)IF EXIST "%~DP0%CURRENTTARGET%.reg" (regedit /S "%~DP0%CURRENTTARGET%.reg"SET /A DONE=DONE+1)GOTO CYCLE:SECURITYECHO.ECHO Sorry, it looks like some security program is preventingECHO access to needed programs or locationsECHO ^(eg %WINDIR%\System32\reg.exe or regedit.exe etc or HKCR^)ECHO.ECHO Please try disabling the product and run the bat again!IF NOT EXIST "%~DP0Office\%CURRENTTARGET%.reg" RMDIR "%~DP0Office" /Q /SGOTO END:ERRORECHO :^( Oops Your PC ran into a problem that it couldn'tECHO handle, then it asked a question.ECHO.ECHO "Shall we play a game?"ECHO.ECHO I told it NO for you but then it got mad and broke this BAT.ECHO.ECHO Better go and complain now!ECHO http://forums.sandboxie.com/phpBB3/viewtopic.php?f=22^&amp;t=22829ECHO.GOTO END:ENDTITLE !!KEEP OFFICE FOLDER!!ECHO.ECHO -----------------------------------------------------------------------------RMDIR "%~DP0Office\Fix" /Q /S 1&gt;NUL 2&gt;NULRMDIR "%~DP0Office\Temp" /Q /S 1&gt;NUL 2&gt;NULECHO %DONE% registry locations processed.IF %DONE%==0 (ECHO.ECHO Oops! It looks like nothing changed.GOTO NOFOLDER)ECHO.ECHO !KEEP a copy of the new "Office" folder!ECHO It contains the files needed to restore the original entries.ECHO.ECHO This new "Office" folder will be in the same location as the bat.:NOFOLDERECHO -----------------------------------------------------------------------------ECHO.ECHO Press any key to exit...PAUSE 1&gt;NULEXIT</code></pre></div>Good Luck! :P<p>Statistics: Posted by <a href="https://forums.sandboxie.com/phpBB3/memberlist.php?mode=viewprofile&amp;u=29518">Syrinx</a> — Mon Aug 08, 2016 3:03 am</p><hr />
]]></content>
	</entry>
		<entry>
		<author><name><![CDATA[Mr.X]]></name></author>
		<updated>2016-07-31T19:42:03-04:00</updated>

		<published>2016-07-31T19:42:03-04:00</published>
		<id>https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=122430#p122430</id>
		<link href="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=122430#p122430"/>
		<title type="html"><![CDATA[Re: Office 2013 non C2R &amp; Excel work around.]]></title>

		
		<content type="html" xml:base="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=122430#p122430"><![CDATA[
@syrinx<br><br>As usual, you did a spectacular job. Thanks a lot.<p>Statistics: Posted by <a href="https://forums.sandboxie.com/phpBB3/memberlist.php?mode=viewprofile&amp;u=16759">Mr.X</a> — Sun Jul 31, 2016 7:42 pm</p><hr />
]]></content>
	</entry>
		<entry>
		<author><name><![CDATA[Syrinx]]></name></author>
		<updated>2016-07-31T17:48:11-04:00</updated>

		<published>2016-07-31T17:48:11-04:00</published>
		<id>https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=122428#p122428</id>
		<link href="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=122428#p122428"/>
		<title type="html"><![CDATA[Re: Office 2013 non C2R &amp; Excel work around.]]></title>

		
		<content type="html" xml:base="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=122428#p122428"><![CDATA[
There were a couple of issues with the previous bat concerning paths with a space in them....<br>Previously the scripts posted for Excel and Word only fixed the 'Open' keys for:<br><br>Excel.Sheet.12<br>Excel.Sheet.8<br>or<br>Word.Document.12<br>Word.Document.8<br><br>So here's a new script that attempts to fix not only the 'Open' keys but also the entries for Edit, New, OpenAsReadOnly, Print, and ViewProtected for:<br>Excel.Backup<br>Excel.Chart<br>Excel.CSV<br>Excel.Macrosheet<br>Excel.OpenDocumentSpreadsheet.12<br>Excel.Sheet.12<br>Excel.Sheet.8<br>Excel.SheetBinaryMacroEnabled.12<br>Excel.SheetMacroEnabled.12<br>Excel.Template<br>Excel.Template.8<br>Excel.TemplateMacroEnabled<br>Word.Backup.8<br>Word.Document.12<br>Word.Document.8<br>Word.DocumentMacroEnabled.12<br>Word.DocumentMacroEnabled.8<br>Word.RTF.8<br>Word.Template.12<br>Word.Template.8<br>Word.TemplateMacroEnabled.12<br>Word.TemplateMacroEnabled.8<br><br>This should result in an easier 'alert/error free' experience between Office and SBIE where previously a user might have been getting annoying errors upon opening a document or spreadsheet before the program was loaded and protected within SBIE and being left with nothing but the program opened.<br>I can't guarantee it will fix all of the potential entries or possible alerts but if it happens to involve the /dde string (eg there was a problem sending the command to the program) there's a good chance this will do it for you.<br><br>If you have the same issue with anything other than Excel or Word please let me know as this bat still doesn't cover anything else.<br><br>Here's the new .bat code. You can copy it all into a .txt (eg in notepad) then rename it to bat. [May need to ensure known file extensions are shown in explorer]<br>It will need to be run as Admin due to the fact the registry entries it needs to change are located in the HKCR hive.<br><div class="codebox"><p>CODE: </p><pre><code>@ECHO OFFTITLE EULA: Don't blame me!SET DONE=0IF EXIST "%~DP0Office\EULA.txt" GOTO INITIF EXIST "%~DP0\EULA.txt" GOTO INIT:PROMPTECHO This bat will modify your registry! [Office Related]ECHO.ECHO This bat was made by a user in an effort to aid other users.ECHO.ECHO The author does NOT make any warranty of any kind,ECHO either express or implied. In no event shall the author of thisECHO bat be liable for any consequential, direct, incidentalECHO or indirect damages (including, without limitation,ECHO damages for loss of business profits, business interruption,ECHO loss of business information, destruction of the universeECHO or any other loss) arising from the use of this bat.ECHO.ECHO Do you agree to these terms?ECHO (Y for Yes, N for No)ECHO.SET /P CHOICE=    ^   Make your Choice: SET CHOICE=%CHOICE:~0,1%IF /I "%CHOICE%"=="Y" GOTO INITIF /I "%CHOICE%"=="N" EXITCLSECHO Oops, please try again!ECHO.GOTO PROMPT:INITCLSECHO Checking Access Level...IF EXIST %WINDIR%\AdminTest (RMDIR %WINDIR%\AdminTest /Q /S 1&gt;NUL 2&gt;NULGOTO TEST)IF NOT EXIST %WINDIR%\AdminTest MD %WINDIR%\AdminTest 1&gt;NUL 2&gt;NUL:TESTIF %ERRORLEVEL%==0 (IF EXIST %WINDIR%\AdminTest RMDIR %WINDIR%\AdminTest  /Q /S 1&gt;NUL 2&gt;NULECHO Seems to be running as Admin, continuing...GOTO SELECTION)ECHO.ECHO Sorry, it won't work if you don't (Right click the bat and)ECHO Run as administratorGOTO END:SELECTIONSET /A AUTORESTORE=0TITLE What are you doing?ECHO.ECHO **This bat will modify Office related registry entries!**ECHO.ECHO Choose 1 to Backup and Replace /ddeECHO Choose 2 to Restore /dde using BackupsECHO Choose 3 to Cancel and Exit.ECHO.ECHO **This bat will modify Office related registry entries!**ECHO.SET /P SELECTION=    ^   Which option number would you like to try?: SET SELECTION=%SELECTION:~0,1%IF /I "%SELECTION%"=="1" GOTO ROUND_1IF /I "%SELECTION%"=="2" GOTO ROUND_7IF /I "%SELECTION%"=="3" EXITCLSECHO Oops, please try again!ECHO.GOTO SELECTION:CYCLEIF %NUMBER%==1 SET CURRENTTARGET=Excel.BackupIF %NUMBER%==2 SET CURRENTTARGET=Excel.ChartIF %NUMBER%==3 SET CURRENTTARGET=Excel.CSVIF %NUMBER%==4 SET CURRENTTARGET=Excel.MacrosheetIF %NUMBER%==5 SET CURRENTTARGET=Excel.OpenDocumentSpreadsheet.12IF %NUMBER%==6 SET CURRENTTARGET=Excel.Sheet.12IF %NUMBER%==7 SET CURRENTTARGET=Excel.Sheet.8IF %NUMBER%==8 SET CURRENTTARGET=Excel.SheetBinaryMacroEnabled.12IF %NUMBER%==9 SET CURRENTTARGET=Excel.SheetMacroEnabled.12IF %NUMBER%==10 SET CURRENTTARGET=Excel.TemplateIF %NUMBER%==11 SET CURRENTTARGET=Excel.Template.8IF %NUMBER%==12 SET CURRENTTARGET=Excel.TemplateMacroEnabledIF %NUMBER%==13 SET CURRENTTARGET=Word.Backup.8IF %NUMBER%==14 SET CURRENTTARGET=Word.Document.12IF %NUMBER%==15 SET CURRENTTARGET=Word.Document.8IF %NUMBER%==16 SET CURRENTTARGET=Word.DocumentMacroEnabled.12IF %NUMBER%==17 SET CURRENTTARGET=Word.DocumentMacroEnabled.8IF %NUMBER%==18 SET CURRENTTARGET=Word.RTF.8IF %NUMBER%==19 SET CURRENTTARGET=Word.Template.12IF %NUMBER%==20 SET CURRENTTARGET=Word.Template.8IF %NUMBER%==21 SET CURRENTTARGET=Word.TemplateMacroEnabled.12IF %NUMBER%==22 SET CURRENTTARGET=Word.TemplateMacroEnabled.8IF %NUMBER% GEQ 23 GOTO CHECKROUNDSET /A NUMBER=NUMBER+1IF %AUTORESTORE%==0 GOTO EDITIF %AUTORESTORE%==1 GOTO AUTORESTORE1GOTO ERROR:EDITSET /A ROUNDPREV=%ROUNDNUM%-1reg QUERY "HKEY_CLASSES_ROOT\%CURRENTTARGET%\shell\Print\ddeexec" 1&gt;nul 2&gt;nulif %errorlevel%==5 goto SECURITYif %errorlevel%==1 goto CYCLEIF NOT EXIST "%~DP0Office\%CURRENTTARGET%.reg" regedit /A "%~DP0Office\%CURRENTTARGET%.reg" "HKEY_CLASSES_ROOT\%CURRENTTARGET%\shell"IF NOT EXIST "%~DP0Office\%CURRENTTARGET%.reg" GOTO CYCLEIF %ROUNDNUM%==1 (IF EXIST "%~DP0Office\%CURRENTTARGET%.reg" (SET "SOURCE=%~DP0Office\%CURRENTTARGET%.reg"SET "TARGET=%~DP0Office\Temp\%CURRENTTARGET%.Fixing.%ROUNDNUM%.reg"GOTO REPLACE))IF NOT EXIST "%~DP0Office\Temp\%CURRENTTARGET%.Fixing.%ROUNDPREV%.reg" GOTO CYCLESET "SOURCE=%~DP0Office\Temp\%CURRENTTARGET%.Fixing.%ROUNDPREV%.reg"IF %ROUNDNUM% LEQ 5 (SET "TARGET=%~DP0Office\Temp\%CURRENTTARGET%.Fixing.%ROUNDNUM%.reg"GOTO REPLACE)IF %ROUNDNUM% EQU 6 (SET "TARGET=%~DP0Office\Fix\%CURRENTTARGET%.Fixed.reg"GOTO REPLACE)GOTO CYCLE:CHECKROUNDSET /A ROUNDNUM=ROUNDNUM+1IF %ROUNDNUM% LEQ 6 (SET /A NUMBER=1GOTO Round_%ROUNDNUM%)IF %ROUNDNUM% GEQ 7 GOTO ENDGOTO ERROR:REPLACESETLOCAL ENABLEDELAYEDEXPANSION(FOR /F "tokens=1* delims=:" %%A IN ('findstr /N "^" "%SOURCE%"') DO (SET "LINE=%%B"IF DEFINED LINE SET "LINE=!LINE:%ORIGINAL%=%FIX%!"ECHO(!LINE!)) &gt; "%TARGET%"ENDLOCALIF EXIST "%~DP0Office\Fix\%CURRENTTARGET%.Fixed.reg" (regedit /S "%~DP0Office\Fix\%CURRENTTARGET%.Fixed.reg"IF %ERRORLEVEL%==5 GOTO SECURITYreg DELETE HKEY_CLASSES_ROOT\%CURRENTTARGET%\shell\Edit\ddeexec /f 1&gt;NUL 2&gt;NULreg DELETE HKEY_CLASSES_ROOT\%CURRENTTARGET%\shell\New\ddeexec /f 1&gt;NUL 2&gt;NULreg DELETE HKEY_CLASSES_ROOT\%CURRENTTARGET%\shell\OnenotePrintto\ddeexec /f 1&gt;NUL 2&gt;NULreg DELETE HKEY_CLASSES_ROOT\%CURRENTTARGET%\shell\Open\ddeexec /f 1&gt;NUL 2&gt;NULreg DELETE HKEY_CLASSES_ROOT\%CURRENTTARGET%\shell\OpenAsReadOnly\ddeexec /f 1&gt;NUL 2&gt;NULreg DELETE HKEY_CLASSES_ROOT\%CURRENTTARGET%\shell\Print\ddeexec /f 1&gt;NUL 2&gt;NULreg DELETE HKEY_CLASSES_ROOT\%CURRENTTARGET%\shell\Printto\ddeexec /f 1&gt;NUL 2&gt;NULreg DELETE HKEY_CLASSES_ROOT\%CURRENTTARGET%\shell\ViewProtected\ddeexec /f 1&gt;NUL 2&gt;NULSET /A DONE=DONE+1)GOTO CYCLE:ROUND_1TITLE Replace /ddeCLSECHO.ECHO Starting Pass 1 (This should be quick)IF NOT EXIST "%~DP0Office" MD "%~DP0Office" 1&gt;NULIF NOT EXIST "%~DP0Office\Fix" MD "%~DP0Office\Fix" 1&gt;NULIF NOT EXIST "%~DP0Office\Temp" MD "%~DP0Office\Temp" 1&gt;NULIF NOT EXIST "%~DP0Office\EULA.txt" (IF NOT EXIST "%~DP0\EULA.txt" (TYPE NUL &gt; "%~DP0Office\EULA.txt")SET /A ROUNDNUM=1SET /A NUMBER=1SET "ORIGINAL= /dde"SET "FIX= \"%%1\""GOTO CYCLE:ROUND_2ECHO.ECHO Starting Pass 2 (This may take a bit)COPY /Y "%~0" "%~DP0Office\BACKUP.bat" 1&gt;NUL 2&gt;NULSET "ORIGINAL=2f,64,64,65"SET "FIX=22,25,31,22"GOTO CYCLE:ROUND_3ECHO .SET "ORIGINAL=2f,64,64"SET "FIX=22,25,31"GOTO CYCLE:ROUND_4ECHO ..SET "ORIGINAL=  65,00,00"SET "FIX=  22,00,00"GOTO CYCLE:ROUND_5ECHO ...SET "ORIGINAL=2f,64"SET "FIX=22,25"GOTO CYCLE:ROUND_6ECHO ....SET "ORIGINAL=  64,65,00,00"SET "FIX=  31,22,00,00"GOTO CYCLE:ROUND_7CLSECHO.ECHO Attempting to restore Original registry backups.SET /A AUTORESTORE=1SET /A ROUNDNUM=7SET /A NUMBER=1GOTO CYCLE:AUTORESTORE1IF EXIST "%~DP0Office\%CURRENTTARGET%.reg" (regedit /S "%~DP0Office\%CURRENTTARGET%.reg"SET /A DONE=DONE+1)IF EXIST "%~DP0%CURRENTTARGET%.reg" (regedit /S "%~DP0%CURRENTTARGET%.reg"SET /A DONE=DONE+1)GOTO CYCLE:SECURITYECHO.ECHO Sorry, it looks like some security program is preventingECHO access to needed programs or locationsECHO (eg %SYSTEMROOT%\system32\reg.exe or regedit.exe etc or HKCR)ECHO.ECHO Please try disabling the product and run the bat again!IF NOT EXIST "%~DP0Office\%CURRENTTARGET%.reg" RMDIR "%~DP0Office" /Q /SGOTO END:ERRORECHO :( Oops Your PC ran into a problem that it couldn'tECHO handle, then it asked a question.ECHO.ECHO "Shall we play a game?"ECHO.ECHO I told it "NO" for you but then it got mad and broke this BAT.ECHO.ECHO Better go and complain now!ECHO http://forums.sandboxie.com/phpBB3/viewtopic.php?f=22^&amp;t=22829ECHO.GOTO END:ENDTITLE !!KEEP OFFICE FOLDER!!ECHO.ECHO -----------------------------------------------------------------------------RMDIR "%~DP0Office\Fix" /Q /S 1&gt;NUL 2&gt;NULRMDIR "%~DP0Office\Temp" /Q /S 1&gt;NUL 2&gt;NULIF %DONE%==0 ECHO Oops! It looks like nothing changed.ECHO %DONE% registry locations processed.IF %DONE%==0 GOTO NOFOLDERECHO.ECHO !KEEP a copy of the new "Office" folder!ECHO It contains the files needed to restore the original entries.ECHO.ECHO This new "Office" folder will be in the same location as the bat.:NOFOLDERECHO -----------------------------------------------------------------------------ECHO.ECHO Press any key to exit...PAUSE 1&gt;NULEXIT</code></pre></div>Upon completing there will be a new folder labeled "<em><span style="text-decoration: underline">Office</span></em>" in the same location that the bat is launched from.<br>It is <strong><span style="text-decoration: underline">VERY IMPORTANT</span></strong> that you <span style="text-decoration: underline"><strong>KEEP</strong></span> a copy of this folder someplace. It retains the original registry entries in case you need to restore them (undo this bat).<br><br>If you're having trouble getting the code above into a bat or you just want to download it, here's the same code inside a ready to launch .bat<br><a href="http://www.mediafire.com/download/ona7q5090za2aa7/Office_DDE.bat" class="postlink">http://www.mediafire.com/download/ona7q ... ce_DDE.bat</a><br><a href="http://www107.zippyshare.com/v/lVIaJMaU/file.html" class="postlink">http://www107.zippyshare.com/v/lVIaJMaU/file.html</a><br><br>I spent a good chunk of this past weeks free time working on this one and tried to make it more resilient but there is a chance that it still has a couple bugs. It's also not the prettiest or most optimized bat ever created but being a newb I think it turned out pretty well. Still, if you have any issues or suggestions, feel free to let me know.<p>Statistics: Posted by <a href="https://forums.sandboxie.com/phpBB3/memberlist.php?mode=viewprofile&amp;u=29518">Syrinx</a> — Sun Jul 31, 2016 5:48 pm</p><hr />
]]></content>
	</entry>
		<entry>
		<author><name><![CDATA[Syrinx]]></name></author>
		<updated>2016-07-25T13:36:13-04:00</updated>

		<published>2016-07-25T13:36:13-04:00</published>
		<id>https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=122335#p122335</id>
		<link href="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=122335#p122335"/>
		<title type="html"><![CDATA[Re: Office 2013 non C2R &amp; Excel work around.]]></title>

		
		<content type="html" xml:base="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=122335#p122335"><![CDATA[
Already posted this elsewhere but I hunted it down and am re-posting it here because a couple people mentioned having the same trouble with word documents on some versions of Office and it'd be better to consolidate them I think.<br><br>This one is for Word, the one for excel is still posted above:<div class="codebox"><p>CODE: </p><pre><code>    @echo off    reg.exe export "HKEY_CLASSES_ROOT\Word.Document.8\shell\Open" %~dp0Export8.reg    cmd /a /c type %~dp0Export8.reg &gt; %~dp0Export8A.reg    reg.exe export "HKEY_CLASSES_ROOT\Word.Document.12\shell\Open" %~dp0Export12.reg    cmd /a /c type %~dp0Export12.reg &gt; %~dp0Export12A.reg    set "WordVariable= \"%%1\""    set "Original8=2F,00,64,00,64,00,65"    set "Fix8=22,00,25,00,31,00,22"    set "source=%~dp0Export8A.reg"    set "target=%~dp0Fix8.reg"    setlocal enableDelayedExpansion    (       for /F "tokens=1* delims=:" %%a in ('findstr /N "^" %source%') do (          set "line=%%b"          if defined line set "line=!line:%Original8%=%Fix8%!"          echo(!line!       )    ) &gt; %target%    endlocal    set "DDE8= /dde"    set "F8=%WordVariable%"    set "source=%~dp0Fix8.reg"    set "target=%~dp0Fix8B.reg"    setlocal enableDelayedExpansion    (       for /F "tokens=1* delims=:" %%a in ('findstr /N "^" %source%') do (          set "line=%%b"          if defined line set "line=!line:%DDE8%=%F8%!"          echo(!line!       )    ) &gt; %target%    endlocal    set "Original12=2F,00,64,00,64,00,65"    set "Fix12=22,00,25,00,31,00,22"    set "source=%~dp0Export12A.reg"    set "target=%~dp0Fix12.reg"    setlocal enableDelayedExpansion    (       for /F "tokens=1* delims=:" %%a in ('findstr /N "^" %source%') do (          set "line=%%b"          if defined line set "line=!line:%Original12%=%Fix12%!"          echo(!line!       )    ) &gt; %target%    endlocal    set "DDE12= /dde"    set "F12=%WordVariable%"    set "source=%~dp0Fix12.reg"    set "target=%~dp0Fix12B.reg"    setlocal enableDelayedExpansion    (       for /F "tokens=1* delims=:" %%a in ('findstr /N "^" %source%') do (          set "line=%%b"          if defined line set "line=!line:%DDE12%=%F12%!"          echo(!line!       )    ) &gt; %target%    endlocal    regedit /s "%~dp0Fix8B.reg"    regedit /s "%~dp0Fix12B.reg"    del %~dp0Export8A.reg    del %~dp0Export12A.reg    del %~dp0Fix8.reg    del %~dp0Fix12.reg    del %~dp0Fix8B.reg    del %~dp0Fix12B.reg    REG DELETE HKEY_CLASSES_ROOT\Word.Document.8\shell\Open\ddeexec /f    REG DELETE HKEY_CLASSES_ROOT\Word.Document.12\shell\Open\ddeexec /f</code></pre></div>Also, just like Excel, there are separate entries for macro enabled documents which this doesn't touch but either can be modified with a search and replace for all inside notepad to change those as well. eg<br>"Word.Document." replaced with "Word.DocumentMacroEnabled."<br>and<br>"Excel.Sheet." replaced with "Excel.SheetMacroEnabled." for the registry key locations<p>Statistics: Posted by <a href="https://forums.sandboxie.com/phpBB3/memberlist.php?mode=viewprofile&amp;u=29518">Syrinx</a> — Mon Jul 25, 2016 1:36 pm</p><hr />
]]></content>
	</entry>
		<entry>
		<author><name><![CDATA[Craig@Invincea]]></name></author>
		<updated>2016-04-29T11:04:38-04:00</updated>

		<published>2016-04-29T11:04:38-04:00</published>
		<id>https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120514#p120514</id>
		<link href="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120514#p120514"/>
		<title type="html"><![CDATA[Re: Office 2013 non C2R &amp; Excel work around.]]></title>

		
		<content type="html" xml:base="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120514#p120514"><![CDATA[
This batch file by @Syrinx w/ the assistance of @MrX should help!<br><div class="codebox"><p>CODE: </p><pre><code>@echo offreg.exe export "HKEY_CLASSES_ROOT\Excel.Sheet.8\shell\Open" %~dp0Export8.regcmd /a /c type %~dp0Export8.reg &gt; %~dp0Export8A.regreg.exe export "HKEY_CLASSES_ROOT\Excel.Sheet.12\shell\Open" %~dp0Export12.regcmd /a /c type %~dp0Export12.reg &gt; %~dp0Export12A.regset "ExcelVariable= \"%%1\""set "Original8=2F,00,64,00,64,00,65"set "Fix8=22,00,25,00,31,00,22"set "source=%~dp0Export8A.reg"set "target=%~dp0Fix8.reg"setlocal enableDelayedExpansion(  for /F "tokens=1* delims=:" %%a in ('findstr /N "^" %source%') do (  set "line=%%b"  if defined line set "line=!line:%Original8%=%Fix8%!"  echo(!line!  )) &gt; %target%endlocalset "DDE8= /dde"set "F8=%ExcelVariable%"set "source=%~dp0Fix8.reg"set "target=%~dp0Fix8B.reg"setlocal enableDelayedExpansion(  for /F "tokens=1* delims=:" %%a in ('findstr /N "^" %source%') do (  set "line=%%b"  if defined line set "line=!line:%DDE8%=%F8%!"  echo(!line!  )) &gt; %target%endlocalset "Original12=2F,00,64,00,64,00,65"set "Fix12=22,00,25,00,31,00,22"set "source=%~dp0Export12A.reg"set "target=%~dp0Fix12.reg"setlocal enableDelayedExpansion(  for /F "tokens=1* delims=:" %%a in ('findstr /N "^" %source%') do (  set "line=%%b"  if defined line set "line=!line:%Original12%=%Fix12%!"  echo(!line!  )) &gt; %target%endlocalset "DDE12= /dde"set "F12=%ExcelVariable%"set "source=%~dp0Fix12.reg"set "target=%~dp0Fix12B.reg"setlocal enableDelayedExpansion(  for /F "tokens=1* delims=:" %%a in ('findstr /N "^" %source%') do (  set "line=%%b"  if defined line set "line=!line:%DDE12%=%F12%!"  echo(!line!  )) &gt; %target%endlocalregedit /s "%~dp0Fix8B.reg"regedit /s "%~dp0Fix12B.reg"del %~dp0Export8A.regdel %~dp0Export12A.regdel %~dp0Fix8.regdel %~dp0Fix12.regdel %~dp0Fix8B.regdel %~dp0Fix12B.regREG DELETE HKEY_CLASSES_ROOT\Excel.Sheet.8\shell\Open\ddeexec /fREG DELETE HKEY_CLASSES_ROOT\Excel.Sheet.12\shell\Open\ddeexec /f</code></pre></div><p>Statistics: Posted by <a href="https://forums.sandboxie.com/phpBB3/memberlist.php?mode=viewprofile&amp;u=27430">Craig@Invincea</a> — Fri Apr 29, 2016 11:04 am</p><hr />
]]></content>
	</entry>
		<entry>
		<author><name><![CDATA[Craig@Invincea]]></name></author>
		<updated>2016-04-29T10:54:30-04:00</updated>

		<published>2016-04-29T10:54:30-04:00</published>
		<id>https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120513#p120513</id>
		<link href="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120513#p120513"/>
		<title type="html"><![CDATA[Re: Office 2013 non C2R &amp; Excel work around.]]></title>

		
		<content type="html" xml:base="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120513#p120513"><![CDATA[
<blockquote><div><cite>Sklipnott wrote:</cite>I spoke too early the other day indeed:<br><blockquote><div><cite>Sklipnott wrote:</cite>I can confirm those registry tweaks worked indeed.</div></blockquote>Those scripts <strong>won't work</strong> on different machines. Unfortunately I don't have scripting skills to fix them. Please provide a solution.</div></blockquote>A user (Syrinx) in contributing to working on this, and it will be reviewed by us. There is no ETA at this time.<p>Statistics: Posted by <a href="https://forums.sandboxie.com/phpBB3/memberlist.php?mode=viewprofile&amp;u=27430">Craig@Invincea</a> — Fri Apr 29, 2016 10:54 am</p><hr />
]]></content>
	</entry>
		<entry>
		<author><name><![CDATA[Sklipnott]]></name></author>
		<updated>2016-04-29T10:23:39-04:00</updated>

		<published>2016-04-29T10:23:39-04:00</published>
		<id>https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120512#p120512</id>
		<link href="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120512#p120512"/>
		<title type="html"><![CDATA[Re: Office 2013 non C2R &amp; Excel work around.]]></title>

		
		<content type="html" xml:base="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120512#p120512"><![CDATA[
I spoke too early the other day indeed:<br><blockquote><div><cite>Sklipnott wrote:</cite>I can confirm those registry tweaks worked indeed.</div></blockquote>Those scripts <strong>won't work</strong> on different machines. Unfortunately I don't have scripting skills to fix them. Please provide a solution.<p>Statistics: Posted by <a href="https://forums.sandboxie.com/phpBB3/memberlist.php?mode=viewprofile&amp;u=30889">Sklipnott</a> — Fri Apr 29, 2016 10:23 am</p><hr />
]]></content>
	</entry>
		<entry>
		<author><name><![CDATA[Craig@Invincea]]></name></author>
		<updated>2016-04-25T20:56:30-04:00</updated>

		<published>2016-04-25T20:56:30-04:00</published>
		<id>https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120471#p120471</id>
		<link href="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120471#p120471"/>
		<title type="html"><![CDATA[Re: Office 2013 non C2R &amp; Excel work around.]]></title>

		
		<content type="html" xml:base="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120471#p120471"><![CDATA[
I moved this topic to contributed utilities. Great info from syrinx and it can come in handy in the future so it doesn't get lost in the noise of the general forum posts.<p>Statistics: Posted by <a href="https://forums.sandboxie.com/phpBB3/memberlist.php?mode=viewprofile&amp;u=27430">Craig@Invincea</a> — Mon Apr 25, 2016 8:56 pm</p><hr />
]]></content>
	</entry>
		<entry>
		<author><name><![CDATA[Sklipnott]]></name></author>
		<updated>2016-04-25T11:07:34-04:00</updated>

		<published>2016-04-25T11:07:34-04:00</published>
		<id>https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120456#p120456</id>
		<link href="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120456#p120456"/>
		<title type="html"><![CDATA[Re: Office 2013 non C2R &amp; Excel work around.]]></title>

		
		<content type="html" xml:base="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120456#p120456"><![CDATA[
I can confirm those registry tweaks worked indeed.<br><br>Thanks a lot Mr. syrinx for your kind reply.<br><br>Also thanks to Invincea for keep maintaining Sandboxie too.<p>Statistics: Posted by <a href="https://forums.sandboxie.com/phpBB3/memberlist.php?mode=viewprofile&amp;u=30889">Sklipnott</a> — Mon Apr 25, 2016 11:07 am</p><hr />
]]></content>
	</entry>
		<entry>
		<author><name><![CDATA[Mr.X]]></name></author>
		<updated>2016-04-24T20:22:41-04:00</updated>

		<published>2016-04-24T20:22:41-04:00</published>
		<id>https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120442#p120442</id>
		<link href="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120442#p120442"/>
		<title type="html"><![CDATA[Re: There was a problem sending the command to the program.]]></title>

		
		<content type="html" xml:base="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120442#p120442"><![CDATA[
@syrinx<br><br>Thanks bro! Thank you so much! It works! <br><br>Long time I've been looking for a solution to this problem as well, a long time.<br><br>You're very kind.  <img class="smilies" src="./../../.https://forums.sandboxie.com/phpBB3/images/smilies/icon_cool.gif" width="15" height="15" alt="8)" title="Cool"><p>Statistics: Posted by <a href="https://forums.sandboxie.com/phpBB3/memberlist.php?mode=viewprofile&amp;u=16759">Mr.X</a> — Sun Apr 24, 2016 8:22 pm</p><hr />
]]></content>
	</entry>
		<entry>
		<author><name><![CDATA[Syrinx]]></name></author>
		<updated>2016-04-24T20:27:27-04:00 </updated>

		<published>2016-04-24T19:43:02-04:00</published>
		<id>https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120441#p120441</id>
		<link href="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120441#p120441"/>
		<title type="html"><![CDATA[Re: There was a problem sending the command to the program.]]></title>

		
		<content type="html" xml:base="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120441#p120441"><![CDATA[
Note:You may want to open regedit and export the HKEY_CLASSES_ROOT\Excel.Sheet.8\ and HKEY_CLASSES_ROOT\Excel.Sheet.12\ keys prior to testing this in case you need to revert them!<br><span style="font-size: 150%; line-height: normal"><strong>*Highly recommended*</strong></span><br><br>Please give one of these a try depending on your version eg 2013/2016 and 32 or 64 build assuming they were installed to the default locations...Have only tested the 2013 32 bit one in a VM so I'm unsure of the others! ~ The x64 entries ones are a bit more likely to fail and if so if someone could share the exported key I can likely correct it. :-/<br><br>Changes are essentially removing the ddeexec key and changing the /dde at the end of all of them to "%1" to prevent usage of the dynamic data exchange parts which seem to cause the error and just pass the file path instead.<br><br>Just save the appropriate one to a text file, rename to .reg and then add to the registry.<br><br>Excel 2013 (x86)<blockquote class="uncited"><div>Windows Registry Editor Version 5.00<br><br>[-HKEY_CLASSES_ROOT\Excel.Sheet.8\shell\Open\ddeexec]<br><br>[HKEY_CLASSES_ROOT\Excel.Sheet.8\shell\Open\command]<br>@="\"C:\\Program Files (x86)\\Microsoft Office\\Office15\\EXCEL.EXE\" \"%1\""<br>"command"=hex(7):7a,00,71,00,50,00,5e,00,56,00,35,00,21,00,21,00,21,00,21,00,\<br>  21,00,21,00,21,00,21,00,21,00,4d,00,4b,00,4b,00,53,00,6b,00,45,00,58,00,43,\<br>  00,45,00,4c,00,46,00,69,00,6c,00,65,00,73,00,3e,00,6c,00,56,00,57,00,41,00,\<br>  28,00,54,00,56,00,6b,00,4d,00,41,00,49,00,53,00,35,00,44,00,68,00,5d,00,33,\<br>  00,6e,00,56,00,4f,00,20,00,22,00,25,00,31,00,22,00,00,00,00,00<br><br>[-HKEY_CLASSES_ROOT\Excel.Sheet.12\shell\Open\ddeexec]<br><br>[HKEY_CLASSES_ROOT\Excel.Sheet.12\shell\Open\command]<br>@="\"C:\\Program Files (x86)\\Microsoft Office\\Office15\\EXCEL.EXE\" \"%1\""<br>"command"=hex(7):7a,00,71,00,50,00,5e,00,56,00,35,00,21,00,21,00,21,00,21,00,\<br>  21,00,21,00,21,00,21,00,21,00,4d,00,4b,00,4b,00,53,00,6b,00,45,00,58,00,43,\<br>  00,45,00,4c,00,46,00,69,00,6c,00,65,00,73,00,3e,00,6c,00,56,00,57,00,41,00,\<br>  28,00,54,00,56,00,6b,00,4d,00,41,00,49,00,53,00,35,00,44,00,68,00,5d,00,33,\<br>  00,6e,00,56,00,4f,00,20,00,22,00,25,00,31,00,22,00,00,00,00,00</div></blockquote>Excel 2013 (x64)<blockquote class="uncited"><div>Windows Registry Editor Version 5.00<br><br>[-HKEY_CLASSES_ROOT\Excel.Sheet.8\shell\Open\ddeexec]<br><br>[HKEY_CLASSES_ROOT\Excel.Sheet.8\shell\Open\command]<br>@="\"C:\\Program Files\\Microsoft Office\\Office15\\EXCEL.EXE\" \"%1\""<br>"command"=hex(7):7a,00,71,00,50,00,5e,00,56,00,35,00,21,00,21,00,21,00,21,00,\<br>  21,00,21,00,21,00,21,00,21,00,4d,00,4b,00,4b,00,53,00,6b,00,45,00,58,00,43,\<br>  00,45,00,4c,00,46,00,69,00,6c,00,65,00,73,00,3e,00,6c,00,56,00,57,00,41,00,\<br>  28,00,54,00,56,00,6b,00,4d,00,41,00,49,00,53,00,35,00,44,00,68,00,5d,00,33,\<br>  00,6e,00,56,00,4f,00,20,00,22,00,25,00,31,00,22,00,00,00,00,00<br><br>[-HKEY_CLASSES_ROOT\Excel.Sheet.12\shell\Open\ddeexec]<br><br>[HKEY_CLASSES_ROOT\Excel.Sheet.12\shell\Open\command]<br>@="\"C:\\Program Files\\Microsoft Office\\Office15\\EXCEL.EXE\" \"%1\""<br>"command"=hex(7):7a,00,71,00,50,00,5e,00,56,00,35,00,21,00,21,00,21,00,21,00,\<br>  21,00,21,00,21,00,21,00,21,00,4d,00,4b,00,4b,00,53,00,6b,00,45,00,58,00,43,\<br>  00,45,00,4c,00,46,00,69,00,6c,00,65,00,73,00,3e,00,6c,00,56,00,57,00,41,00,\<br>  28,00,54,00,56,00,6b,00,4d,00,41,00,49,00,53,00,35,00,44,00,68,00,5d,00,33,\<br>  00,6e,00,56,00,4f,00,20,00,22,00,25,00,31,00,22,00,00,00,00,00</div></blockquote>Excel 2016 (x86)<blockquote class="uncited"><div>Windows Registry Editor Version 5.00<br><br><br>[-HKEY_CLASSES_ROOT\Excel.Sheet.12\shell\Open\ddeexec]<br><br>[HKEY_CLASSES_ROOT\Excel.Sheet.12\shell\Open\command]<br>@="\"C:\\Program Files (x86)\\Microsoft Office\\Office16\\EXCEL.EXE\" \"%1\""<br>"command"=hex(7):7a,00,6e,00,3d,00,42,00,56,00,35,00,21,00,21,00,21,00,21,00,\<br>  21,00,21,00,21,00,21,00,21,00,4d,00,4b,00,4b,00,53,00,6b,00,45,00,58,00,43,\<br>  00,45,00,4c,00,46,00,69,00,6c,00,65,00,73,00,3e,00,3f,00,25,00,38,00,47,00,\<br>  69,00,63,00,4b,00,63,00,76,00,39,00,6f,00,49,00,60,00,6b,00,77,00,24,00,3d,\<br>  00,5b,00,55,00,5b,00,20,00,22,00,25,00,31,00,22,00,00,00,00,00<br><br>[-HKEY_CLASSES_ROOT\Excel.Sheet.8\shell\Open\ddeexec]<br><br>[HKEY_CLASSES_ROOT\Excel.Sheet.8\shell\Open\command]<br>@="\"C:\\Program Files (x86)\\Microsoft Office\\Office16\\EXCEL.EXE\" \"%1\""<br>"command"=hex(7):7a,00,6e,00,3d,00,42,00,56,00,35,00,21,00,21,00,21,00,21,00,\<br>  21,00,21,00,21,00,21,00,21,00,4d,00,4b,00,4b,00,53,00,6b,00,45,00,58,00,43,\<br>  00,45,00,4c,00,46,00,69,00,6c,00,65,00,73,00,3e,00,3f,00,25,00,38,00,47,00,\<br>  69,00,63,00,4b,00,63,00,76,00,39,00,6f,00,49,00,60,00,6b,00,77,00,24,00,3d,\<br>  00,5b,00,55,00,5b,00,20,00,22,00,25,00,31,00,22,00,00,00,00,00</div></blockquote>Excel 2016 (x64)<blockquote class="uncited"><div>Windows Registry Editor Version 5.00<br><br><br>[-HKEY_CLASSES_ROOT\Excel.Sheet.12\shell\Open\ddeexec]<br><br>[HKEY_CLASSES_ROOT\Excel.Sheet.12\shell\Open\command]<br>@="\"C:\\Program Files\\Microsoft Office\\Office16\\EXCEL.EXE\" \"%1\""<br>"command"=hex(7):7a,00,6e,00,3d,00,42,00,56,00,35,00,21,00,21,00,21,00,21,00,\<br>  21,00,21,00,21,00,21,00,21,00,4d,00,4b,00,4b,00,53,00,6b,00,45,00,58,00,43,\<br>  00,45,00,4c,00,46,00,69,00,6c,00,65,00,73,00,3e,00,3f,00,25,00,38,00,47,00,\<br>  69,00,63,00,4b,00,63,00,76,00,39,00,6f,00,49,00,60,00,6b,00,77,00,24,00,3d,\<br>  00,5b,00,55,00,5b,00,20,00,22,00,25,00,31,00,22,00,00,00,00,00<br><br>[-HKEY_CLASSES_ROOT\Excel.Sheet.8\shell\Open\ddeexec]<br><br>[HKEY_CLASSES_ROOT\Excel.Sheet.8\shell\Open\command]<br>@="\"C:\\Program Files\\Microsoft Office\\Office16\\EXCEL.EXE\" \"%1\""<br>"command"=hex(7):7a,00,6e,00,3d,00,42,00,56,00,35,00,21,00,21,00,21,00,21,00,\<br>  21,00,21,00,21,00,21,00,21,00,4d,00,4b,00,4b,00,53,00,6b,00,45,00,58,00,43,\<br>  00,45,00,4c,00,46,00,69,00,6c,00,65,00,73,00,3e,00,3f,00,25,00,38,00,47,00,\<br>  69,00,63,00,4b,00,63,00,76,00,39,00,6f,00,49,00,60,00,6b,00,77,00,24,00,3d,\<br>  00,5b,00,55,00,5b,00,20,00,22,00,25,00,31,00,22,00,00,00,00,00</div></blockquote><p>Statistics: Posted by <a href="https://forums.sandboxie.com/phpBB3/memberlist.php?mode=viewprofile&amp;u=29518">Syrinx</a> — Sun Apr 24, 2016 7:43 pm</p><hr />
]]></content>
	</entry>
		<entry>
		<author><name><![CDATA[Sklipnott]]></name></author>
		<updated>2016-04-24T17:57:25-04:00</updated>

		<published>2016-04-24T17:57:25-04:00</published>
		<id>https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120440#p120440</id>
		<link href="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120440#p120440"/>
		<title type="html"><![CDATA[Re: There was a problem sending the command to the program.]]></title>

		
		<content type="html" xml:base="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120440#p120440"><![CDATA[
<blockquote><div><cite>Craig@Invincea wrote:</cite>Um, any version after 2013 is Click2Run</div></blockquote>This is a legacy MSI installation.<br><blockquote><div><cite>Craig@Invincea wrote:</cite>And there is a long standing "best use" case you should launch Excel first, then open your file. This has been the case long before C2R and is a recommended work around. Just click Excel to have it force open. Then load your file.</div></blockquote>This actually works as expected. Not convenient for me though.<br><blockquote><div><cite>Craig@Invincea wrote:</cite>You can then leave Office/Excel running in the SB and when you click on any DOCx or Excel file, it will force open correctly.</div></blockquote>It doesn't work whatsoever. The already first running Excel instance is running fine, then when double click any .xls/.xlsx file, same error "There was a problem sending the command to the program" pops up.<p>Statistics: Posted by <a href="https://forums.sandboxie.com/phpBB3/memberlist.php?mode=viewprofile&amp;u=30889">Sklipnott</a> — Sun Apr 24, 2016 5:57 pm</p><hr />
]]></content>
	</entry>
		<entry>
		<author><name><![CDATA[Craig@Invincea]]></name></author>
		<updated>2016-04-24T15:28:03-04:00</updated>

		<published>2016-04-24T15:28:03-04:00</published>
		<id>https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120439#p120439</id>
		<link href="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120439#p120439"/>
		<title type="html"><![CDATA[Re: There was a problem sending the command to the program.]]></title>

		
		<content type="html" xml:base="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120439#p120439"><![CDATA[
Um, any version after 2013 is Click2Run.<br><br>there is very very good chance the 2013 version you are using is as well. <br><br>You can determine that by following the instructions here <a href="http://windowsitpro.com/microsoft-office/determining-if-office-installation-click-run-or-not" class="postlink">http://windowsitpro.com/microsoft-offic ... run-or-not</a><br><br>Otherwise, if you don't restart the C2R service injecting the SBIE code, it will not work for you.<br><br>And there is a long standing "best use" case you should launch Excel first, then open your file. This has been the case long before C2R and is a recommended work around. Just click Excel to have it force open. Then load your file. You can then leave Office/Excel running in the SB and when you click on any DOCx or Excel file, it will force open correctly.<p>Statistics: Posted by <a href="https://forums.sandboxie.com/phpBB3/memberlist.php?mode=viewprofile&amp;u=27430">Craig@Invincea</a> — Sun Apr 24, 2016 3:28 pm</p><hr />
]]></content>
	</entry>
		<entry>
		<author><name><![CDATA[Sklipnott]]></name></author>
		<updated>2016-04-24T12:51:28-04:00</updated>

		<published>2016-04-24T12:51:28-04:00</published>
		<id>https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120438#p120438</id>
		<link href="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120438#p120438"/>
		<title type="html"><![CDATA[Re: There was a problem sending the command to the program.]]></title>

		
		<content type="html" xml:base="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120438#p120438"><![CDATA[
<blockquote><div><cite>Craig@Invincea wrote:</cite>Did you restart the Office C2R service as outlined here? <a href="http://forums.sandboxie.com/phpBB3/viewtopic.php?f=11&amp;t=22645" class="postlink">http://forums.sandboxie.com/phpBB3/view ... 11&amp;t=22645</a></div></blockquote>Not using C2R here.<br><blockquote><div><cite>Craig@Invincea wrote:</cite>Have you tried OPENING EXCEL first, then the EXCEL document?</div></blockquote>It actually works yet I purchased Sandboxie for its "Forced Programs" feature. I need this feature to work on Excel.<p>Statistics: Posted by <a href="https://forums.sandboxie.com/phpBB3/memberlist.php?mode=viewprofile&amp;u=30889">Sklipnott</a> — Sun Apr 24, 2016 12:51 pm</p><hr />
]]></content>
	</entry>
		<entry>
		<author><name><![CDATA[Craig@Invincea]]></name></author>
		<updated>2016-04-24T08:23:17-04:00</updated>

		<published>2016-04-24T08:23:17-04:00</published>
		<id>https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120426#p120426</id>
		<link href="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120426#p120426"/>
		<title type="html"><![CDATA[Re: There was a problem sending the command to the program.]]></title>

		
		<content type="html" xml:base="https://forums.sandboxie.com/phpBB3/viewtopic.php?t=22829&amp;p=120426#p120426"><![CDATA[
Did you restart the Office C2R service as outlined here? <a href="http://forums.sandboxie.com/phpBB3/viewtopic.php?f=11&amp;t=22645" class="postlink">http://forums.sandboxie.com/phpBB3/view ... 11&amp;t=22645</a><br><br>Have you tried OPENING EXCEL first, then the EXCEL document?<p>Statistics: Posted by <a href="https://forums.sandboxie.com/phpBB3/memberlist.php?mode=viewprofile&amp;u=27430">Craig@Invincea</a> — Sun Apr 24, 2016 8:23 am</p><hr />
]]></content>
	</entry>
	</feed>
