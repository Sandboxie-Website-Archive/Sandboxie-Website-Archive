<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forums.sandboxie.com/phpBB3/viewtopic.php?f=22&t=11644&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 28 Mar 2020 04:02:32 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>Sandboxie Support &bull; SBTool New Home ;-) Suggestions welcomed...</title>

<link href="styles/sbie_prosilver/theme/print.css" rel="stylesheet">
</head>
<body id="phpbb">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>Sandboxie Support</h1>
		<p>Support Forum for Sandboxie<br /><a href="index.html">https://forums.sandboxie.com/phpBB3/</a></p>

		<h2>SBTool New Home ;-) Suggestions welcomed...</h2>
		<p><a href="viewtopic2bd72bd7.html?f=22&amp;t=11644">https://forums.sandboxie.com/phpBB3/viewtopic.php?f=22&amp;t=11644</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>SBTool New Home ;-) Suggestions welcomed...</h3>
				<div class="date">Posted: <strong>Mon Oct 10, 2011 4:45 am</strong></div>
				<div class="author">by <strong>shawndion</strong></div>
				<div class="content">As suggested by Tzuk...<br>
<br>
SBTool now has a new home in the Contributed Utilities Section.<br>
<br>
In the next message you will find a updated code of the SBTool it's a work in progress that should be fully operational this week (Without having to enter too much data) and because it's Dos Based and none of the commands are locked by windows you won't have any unknown errors.<br>
<br>
The code that I am posting in the next message is in it's experimental phase the reason I am posting it before is so that should anyone have any ideas or suggestions on things to add I'll be able to fit it in the code.<br>
<br>
Don't be shy I want this tool to complement Sandboxie and make all our lives easier...<br>
<br>
Shawn<br>
<br>
One more thing should anyone know of the best hosting place for me to upload the Batch File so that it doesn't get compromised please let me know<br>
Thanks in advance.</div>
			</div>
			<hr />
					<div class="post">
				<h3>SBTool.bat Version .02b (Experimental Phase)</h3>
				<div class="date">Posted: <strong>Mon Oct 10, 2011 4:46 am</strong></div>
				<div class="author">by <strong>shawndion</strong></div>
				<div class="content">:: +-------------------------------------------------------------------------------+<br>
:: +SBTool.bat                                                                     +<br>
:: +Version .02b                                                                   +<br>
:: +                                                                               +<br>
:: +                                                                               +<br>
:: +-------------------------------------------------------------------------------+<br>
<br>
:: +-------------------------------------------------------------------------------+<br>
::                             DEFAULT VARIABLE SETTINGS<br>
:: +-------------------------------------------------------------------------------+<br>
Set Sandbox="C:\Sandbox"<br>
Set FirstBackup=D:\Sandbox_Backup<br>
Set SecondBackup=D:\Sandbox_Modified<br>
Set Container=DefaultBox<br>
Set Original=Unknown<br>
Set Modified=Unknown<br>
<br>
@echo off<br>
:: +-------------------------------------------------------------------------------+<br>
::                                   MENU CHOICES<br>
:: +-------------------------------------------------------------------------------+<br>
:Menu<br>
Set Choices=<br>
Cls<br>
Echo =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=<br>
Echo =                      Sandboxie's All in One Mega Tool                       =<br>
Echo =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=<br>
Echo Please make sure your Sandboxie software is closed before Starting.<br>
Echo What would you like to do?<br>
Echo Type the corresponding letter to the choice you want and <br>
Echo press Enter to continue.<br>
Echo.<br>
Echo. Current Sandbox : %Container% Original : %Original% Modified : %Modified%<br>
Echo. <br>
Echo.<br>
Echo 0 - Settings (Backup, Restore)<br>
Echo 1 - Backup Sandbox<br>
Echo 2 - Different Backup (After running a program twice in Sandbox)<br>
Echo 3 - Restore Sandbox<br>
Echo 4 - Compare (You need to have B and D done for this to work)<br>
Echo 5 - Registry Changes ((You need to have B and D done for this to work)<br>
Echo 6 - Choose Sandbox Container<br>
Echo 7 - Map Drives<br>
Echo 8 - Quit Program<br>
Echo.<br>
SET /P Choices="Please Enter a Selection... "<br>
<br>
if %Choices%==0 goto Locations<br>
if %Choices%==1 goto Backup<br>
if %Choices%==2 goto BackupDiff<br>
if %Choices%==3 goto Restore<br>
if %Choices%==4 goto Compare<br>
if %Choices%==5 goto RegChanges<br>
if %Choices%==6 goto SandboxSelection<br>
if %Choices%==7 goto MapDrives<br>
if %Choices%==8 goto End<br>
goto Menu<br>
<br>
:MapDrives<br>
<br>
if NOT EXIST M:\ (Subst M: "%FirstBackup%\%USERNAME%\%Container%"&amp;set Original="M:"&amp;goto MapSecond)<br>
if NOT EXIST N:\ (Subst N: "%FirstBackup%\%USERNAME%\%Container%"&amp;set Original="N:"&amp;goto MapSecond)<br>
if NOT EXIST O:\ (Subst O: "%FirstBackup%\%USERNAME%\%Container%"&amp;set Original="O:"&amp;goto MapSecond)<br>
if NOT EXIST P:\ (Subst P: "%FirstBackup%\%USERNAME%\%Container%"&amp;set Original="P:"&amp;goto MapSecond)<br>
if NOT EXIST Q:\ (Subst Q: "%FirstBackup%\%USERNAME%\%Container%"&amp;set Original="Q:"&amp;goto MapSecond)<br>
if NOT EXIST R:\ (Subst R: "%FirstBackup%\%USERNAME%\%Container%"&amp;set Original="R:"&amp;goto MapSecond)<br>
if NOT EXIST S:\ (Subst S: "%FirstBackup%\%USERNAME%\%Container%"&amp;set Original="S:"&amp;goto MapSecond)<br>
if NOT EXIST T:\ (Subst T: "%FirstBackup%\%USERNAME%\%Container%"&amp;set Original="T:"&amp;goto MapSecond)<br>
:MapSecond<br>
if NOT EXIST M:\ (Subst M: "%SecondBackup%\%USERNAME%\%Container%"&amp;set Modified="M:"&amp;goto Menu)<br>
if NOT EXIST N:\ (Subst N: "%SecondBackup%\%USERNAME%\%Container%"&amp;set Modified="N:"&amp;goto Menu)<br>
if NOT EXIST O:\ (Subst O: "%SecondBackup%\%USERNAME%\%Container%"&amp;set Modified="O:"&amp;goto Menu)<br>
if NOT EXIST P:\ (Subst P: "%SecondBackup%\%USERNAME%\%Container%"&amp;set Modified="P:"&amp;goto Menu)<br>
if NOT EXIST Q:\ (Subst Q: "%SecondBackup%\%USERNAME%\%Container%"&amp;set Modified="Q:"&amp;goto Menu)<br>
if NOT EXIST R:\ (Subst R: "%SecondBackup%\%USERNAME%\%Container%"&amp;set Modified="R:"&amp;goto Menu)<br>
if NOT EXIST S:\ (Subst S: "%SecondBackup%\%USERNAME%\%Container%"&amp;set Modified="S:"&amp;goto Menu)<br>
if NOT EXIST T:\ (Subst T: "%SecondBackup%\%USERNAME%\%Container%"&amp;set Modified="T:"&amp;goto Menu)<br>
goto Menu<br>
<br>
:Locations<br>
cls<br>
Echo =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=<br>
Echo =             Sandboxie's All in One Mega Tool (Settings)                     =<br>
Echo =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=<br>
Set /P Sandbox="Enter main Sandbox Location ie: C:\sandbox? "<br>
Set /P FirstBackup="Enter the path to your 1st Backup Folder ie: D:\Sandbox_Backup? "<br>
Set /P SecondBackup="Enter the path to your 2nd Backup Folder ie: D:\Sandbox_Modified? "<br>
Set /P Different="Enter the path where you want to store the differences ie: D:\Different? "<br>
goto Menu<br>
<br>
:Backup<br>
cls<br>
xcopy "%Sandbox%\%USERNAME%\%Container%\*.*" "%FirstBackup%\%USERNAME%\%Container%" /e /i /h /y<br>
pause<br>
goto End<br>
<br>
:BackupDiff<br>
cls<br>
echo xcopy "%Sandbox%\%USERNAME%\%Container%\*.*" "%SecondBackup%\%USERNAME%\%Container%" /e /i /h /y<br>
pause<br>
goto End<br>
<br>
:Restore<br>
rd /s /q "%Sandbox%\%USERNAME%\%Container%\"<br>
xcopy "%FirstBackup%\%USERNAME%\%Container%\*.*" "%Sandbox%\%USERNAME%\%Container%\"  /e /i /h /y<br>
pause<br>
goto End<br>
<br>
:Compare<br>
REM ------------------------------------------------------------<br>
REM      Sandboxie Backup / Restore / What Has Changed Tool<br>
REM ------------------------------------------------------------<br>
<br>
rem Set Original=L:<br>
rem Set Modified=M:<br>
rem Set Different=C:\Different<br>
<br>
dir /s /b /ad "%Modified%" &gt; C:\ModFolder.txt<br>
dir /a-d /s /b "%Original%" &gt; C:\Original.txt<br>
dir /a-d /s /b "%Modified%" &gt; C:\Modified.txt<br>
<br>
for /F "tokens=*" %%* in (c:\ModFolder.txt) do call :Foldersub %%*<br>
for /F "tokens=*" %%* in (c:\Original.txt) do call :Originalsub %%*<br>
for /F "tokens=*" %%* in (c:\Modified.txt) do call :Modifiedsub %%*<br>
Goto End<br>
<br>
REM ------------------------------------------------------------<br>
:Foldersub<br>
Set Folder=%*<br>
Set Folder=%Folder:~3%<br>
MD "%Different%\%Folder%"<br>
goto :eof<br>
REM ------------------------------------------------------------<br>
:Originalsub<br>
set One=%*<br>
set Two=%*<br>
set Two=%Modified%%Two:~2%<br>
set Three=%Two:~3%<br>
If EXIST "%Two%" fc /b "%One%" "%Two%" |find /i "no differences" &gt;Nul<br>
SET VALUE=%ERRORLEVEL%<br>
IF %VALUE% == 1 echo f |xcopy "%Two%" "%Different%\%Three%" /H /Y /V &gt;Nul<br>
if NOT EXIST "%Two%" Echo The File located in %TWO% Has been deleted from Original Location. &gt;&gt; C:\DeletedList.txt<br>
goto :eof<br>
REM ------------------------------------------------------------<br>
:Modifiedsub<br>
set One=%*<br>
set Two=%*<br>
set Two=%Original%%Two:~2%<br>
set Three=%Two:~3%<br>
If EXIST "%Two%" fc /b "%One%" "%Two%" |find /i "no differences" &gt;nul<br>
SET VALUE=%ERRORLEVEL%<br>
IF %VALUE% == 1 echo f |xcopy "%One%" "%Different%\%Three%" /H /Y /V &gt;nul<br>
IF NOT EXIST "%Two%" echo f |xcopy "%One%" "%Different%\%Three%" /H /Y /V &gt;Nul<br>
goto :eof<br>
REM ------------------------------------------------------------<br>
:RegChanges<br>
REM EXPERIMENTAL STAGE <br>
<br>
REG LOAD HKEY_USERS\Sandbox_Compaq_Owner_DefaultBox L:\RegHive<br>
REG EXPORT HKEY_USERS\Sandbox_Compaq_Owner_DefaultBox Original.reg<br>
REG UNLOAD HKEY_USERS\Sandbox_Compaq_Owner_DefaultBox<br>
REG LOAD HKEY_USERS\Sandbox_Compaq_Owner_DefaultBox M:\RegHive<br>
REG EXPORT HKEY_USERS\Sandbox_Compaq_Owner_DefaultBox Modified.reg<br>
REG UNLOAD HKEY_USERS\Sandbox_Compaq_Owner_DefaultBox<br>
regdiff modified.reg original.reg -d Changes.reg<br>
goto :eof<br>
<br>
:SandboxSelection<br>
@echo off<br>
set /a counter=0<br>
find "[" c:\Windows\Sandboxie.ini &gt;c:\report.txt<br>
find /V " " C:\report.txt &gt;c:\nospace.txt<br>
find /V "_" C:\nospace.txt &gt;c:\no_.txt<br>
find "[" c:\no_.txt &gt;c:\report.txt<br>
<br>
for /F "tokens=*" %%* in (c:\Report.txt) do call :Originalsub %%*<br>
goto :Schoice<br>
:Originalsub<br>
set str=%*<br>
if "%str%"== "---------- C:\NO_.TXT" goto :eof<br>
if "%str%"== "[GlobalSettings]" goto :eof<br>
set /a counter+=1<br>
set str=%str:~1,-1%<br>
set Box%counter%=%str%<br>
goto :eof<br>
<br>
<br>
:Schoice<br>
cls<br>
Echo Sandbox Choices (Up to 20 Sandboxes)<br>
Echo 01.%box1%<br>
Echo 02.%box2%<br>
Echo 03.%box3%<br>
Echo 04.%box4%<br>
Echo 05.%box5%<br>
Echo 06.%box6%<br>
Echo 07.%box7%<br>
Echo 08.%box8%<br>
Echo 09.%box9%<br>
Echo 10.%box10%<br>
Echo 11.%box11%<br>
Echo 12.%box12%<br>
Echo 13.%box13%<br>
Echo 14.%box14%<br>
Echo 15.%box15%<br>
Echo 16.%box16%<br>
Echo 17.%box17%<br>
Echo 18.%box18%<br>
Echo 19.%box19%<br>
Echo 20.%box20%<br>
Set /P SandboxChoice="Type in the Number of the Sanbox you wish to use?"<br>
if %SandboxChoice%==1 Set Container=%box1%<br>
if %SandboxChoice%==2 Set Container=%box2%<br>
if %SandboxChoice%==3 Set Container=%box3%<br>
if %SandboxChoice%==4 Set Container=%box4%<br>
if %SandboxChoice%==5 Set Container=%box5%<br>
if %SandboxChoice%==6 Set Container=%box6%<br>
if %SandboxChoice%==7 Set Container=%box7%<br>
if %SandboxChoice%==8 Set Container=%box8%<br>
if %SandboxChoice%==9 Set Container=%box9%<br>
if %SandboxChoice%==10 Set Container=%box10%<br>
if %SandboxChoice%==11 Set Container=%box11%<br>
if %SandboxChoice%==12 Set Container=%box12%<br>
if %SandboxChoice%==13 Set Container=%box13%<br>
if %SandboxChoice%==14 Set Container=%box14%<br>
if %SandboxChoice%==15 Set Container=%box15%<br>
if %SandboxChoice%==16 Set Container=%box16%<br>
if %SandboxChoice%==17 Set Container=%box17%<br>
if %SandboxChoice%==18 Set Container=%box18%<br>
if %SandboxChoice%==19 Set Container=%box19%<br>
if %SandboxChoice%==20 Set Container=%box20%<br>
goto Menu<br>
<br>
:End<br>
Set Choices=<br>
Subst /D %Original%<br>
Subst /D %Modified%<br>
cls<br>
Echo Thank you for using SBTools have a nice day.<br>
Pause</div>
			</div>
			<hr />
					<div class="post">
				<h3>Templates.ini</h3>
				<div class="date">Posted: <strong>Sun Oct 16, 2011 10:13 am</strong></div>
				<div class="author">by <strong>pjpj</strong></div>
				<div class="content">I wonder if Templates.ini is modified often enough by users to be included in this?<br>
<br>
I suppose most people would modify through the individual sandboxes rather than mess with this.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Templates.ini</h3>
				<div class="date">Posted: <strong>Thu Jan 12, 2012 2:34 pm</strong></div>
				<div class="author">by <strong>Guest10</strong></div>
				<div class="content"><blockquote><div><cite>pjpj wrote:</cite>I wonder if Templates.ini is modified often enough by users to be included in this?</div></blockquote>I don't see any involvement here, with <span style="text-decoration: underline">templates.ini</span>, and that's how it should be.<br>
<br>
Should<br>
Set Sandbox="C:\Sandbox" <br>
have those quotes around it?<br>
Wouldn't that make "%Sandbox%" be evaluated as:<br>
""C:\Sandbox""</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="America/New York">UTC-04:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
		<div class="copyright">Powered by phpBB&reg; Forum Software &copy; phpBB Limited<br />https://www.phpbb.com/</div>
	</div>
</div>

</body>

<!-- Mirrored from forums.sandboxie.com/phpBB3/viewtopic.php?f=22&t=11644&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 28 Mar 2020 04:02:32 GMT -->
</html>
