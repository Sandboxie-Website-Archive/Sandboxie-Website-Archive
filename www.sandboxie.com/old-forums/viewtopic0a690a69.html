<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forums.sandboxie.com/phpBB3/viewtopic.php?p=109236 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 28 Mar 2020 08:46:16 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>SandBoxIE to harden SRP (software restriction policy)? - Page 3 - Sandboxie Support</title>

	<link rel="alternate" type="application/atom+xml" title="Feed - Sandboxie Support" href="app.php/feed">		<link rel="alternate" type="application/atom+xml" title="Feed - All forums" href="app.php/feed/forums">	<link rel="alternate" type="application/atom+xml" title="Feed - New Topics" href="app.php/feed/topics">	<link rel="alternate" type="application/atom+xml" title="Feed - Active Topics" href="app.php/feed/topics_active">			
	<link rel="canonical" href="viewtopicd404d404.html?t=19811&amp;start=30">

<!--
	phpBB style name: prosilver
	Based on style:   prosilver (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:
-->

<link href="assets/css/font-awesome.mince91ce91.css?assets_version=7" rel="stylesheet">
<link href="styles/sbie_prosilver/theme/stylesheetce91ce91.css?assets_version=7" rel="stylesheet">
<link href="styles/sbie_prosilver/theme/en/stylesheetce91ce91.css?assets_version=7" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/sbie_prosilver/theme/tweaks.css?assets_version=7" rel="stylesheet">
<![endif]-->





</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">


<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>
	<div id="page-header">
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="Home"><span class="site_logo"></span></a>
				<h1>Sandboxie Support</h1>
				<p>Support Forum for Sandboxie</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://forums.sandboxie.com/phpBB3/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
				<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a733a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="https://www.sandboxie.com/old-forums/memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c326c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp83198319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">Home</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index-2.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="44"><a href="viewforumab78ab78.html?f=44" itemprop="url"><span itemprop="title">More Forums</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e631e6.html?f=4" itemprop="url"><span itemprop="title">Feature Requests</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopic4c544c54.html?f=4&amp;t=19811&amp;start=30">SandBoxIE to harden SRP (software restriction policy)?</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Ideas for enhancements to the software<br /></div>


<div class="action-bar bar-top">
	
			<a href="https://www.sandboxie.com/old-forums/posting2758.html?mode=reply&amp;f=4&amp;t=19811" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic9cb39cb3.html?f=4&amp;t=19811&amp;start=30&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://forums.sandboxie.com/phpBB3/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="19811" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			37 posts
							<ul>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopic88a588a5.html?f=4&amp;t=19811&amp;start=15" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopicd6a9d6a9.html?f=4&amp;t=19811" role="button">1</a></li>
				<li><a class="button" href="viewtopic88a588a5.html?f=4&amp;t=19811&amp;start=15" role="button">2</a></li>
			<li class="active"><span>3</span></li>
	</ul>
					</div>
		</div>




			<div id="p109120" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile109120">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="https://www.sandboxie.com/old-forums/memberlist08c3.html?mode=viewprofile&amp;u=5050" class="username">BUCKAROO</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search8ed68ed6.html?author_id=5050&amp;sr=posts">206</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Oct 24, 2010 3:13 am</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content109120">

						<h3 class="first"><a href="#p109120">Re: SandBoxIE to harden SRP (software restriction policy)?</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="https://www.sandboxie.com/old-forums/posting9fbc.html?mode=quote&amp;f=4&amp;p=109120" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author">
									<a class="unread" href="viewtopicf320-2f320.html?p=109120#p109120" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="https://www.sandboxie.com/old-forums/memberlist08c3.html?mode=viewprofile&amp;u=5050" class="username">BUCKAROO</a></strong> &raquo; </span>Wed May 06, 2015 6:16 pm
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>catBot wrote:</cite>Will this library work on winXP-SP3 and how to use it?</div></blockquote>
SbieSRP4.dll is for 32-bit Windows, so I don't see why not, catBot, yes. I coded it with XP in mind, statically linking to system dll exports that will work as far back as 2000 (per deceptive MSDN docs, so for the APIs I suspect further back still, Sandboxie does not even ...) but I've only tested it on 8.1 core (sans AppLocker mind you). CreateRestrictedToken and SaferComputeTokenFromLevel are XP minimum.<br>
<br>
Create a SRP rule for that dll in the path you choose for it, that is if you have that level of protection enabled to need such a manual rule.<br>
<br>
But I am supposing that with SRP, no dlls are permitted outside of \Windows or \Program Files *<br>
<br>
So yeah, extract SbieSRP4.dll to where you think is appropriate and where ever is accessible to all Sandboxes, say, C:\Program Files\Common Files\ (suggesting not to use env variable that could change under process architecture, hard code the path where required).<br>
<br>
Latest release has debug text output via Win32 OutputDebugString which Sysinternals' DebugView will let you monitor (and optionally log to file in the background).<br>
<br>
Either build, your choice from, debug output only when (seldom) triggered by modification to flags we want to reject (just doing its job), or the full OutputDebug\ build for every hooked procedure when called. No calls are being blocked, only the flags are sanitized (both builds do same job, same efficiency except where programs spam those functions in a loop).<br>
<br>
This library has no options to configure.<br>
To install the library, edit Sandboxie.ini<br>
<br>
[GlobalSettings]<br>
<br>
# for 32-bit Windows use<br>
InjectDll=C:\Program Files\Common Files\SbieSRP4.dll<br>
<br>
# for 64-bit Windows use<br>
InjectDll64=C:\Program Files\Common Files\SbieSRP8.dll<br>
<br>
# 64-bit Windows requires both InjectDll* settings.<br>
# 4 and 8 designates the architecture and its pointer size in bytes as apposed to bits.<br>
<br>
And I would recommend that you give the file the Read-only attribute, so that the file cannot be overwritten while Sandboxed, not to say it cannot be overridden though, it can, dlls aren't the most secure things as we know. But the attacker would have to be SbieSRP-aware <img class="smilies" src="images/smilies/icon_wink.gif" width="15" height="15" alt=";)" title="Wink"> or just very imposing and strict, or subtle and unforgiving. <img class="smilies" src="images/smilies/icon_twisted.gif" width="15" height="15" alt=":twisted:" title="Twisted Evil"><br>
<br>
SbieSRP hooks can safely piggyback another, that is if you wanted to run both builds at the same time, silly may be but it works (two InjectDll setting for functionally the same dll with a different filename or in a different directory).</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p109228" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile109228">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="https://www.sandboxie.com/old-forums/memberlista01f.html?mode=viewprofile&amp;u=24942" class="username">catBot</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchb719b719.html?author_id=24942&amp;sr=posts">22</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Mon Nov 03, 2014 8:40 am</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content109228">

						<h3 ><a href="#p109228">Re: SandBoxIE to harden SRP (software restriction policy)?</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="https://www.sandboxie.com/old-forums/posting410c.html?mode=quote&amp;f=4&amp;p=109228" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author">
									<a class="unread" href="viewtopicaf2baf2b.html?p=109228#p109228" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="https://www.sandboxie.com/old-forums/memberlista01f.html?mode=viewprofile&amp;u=24942" class="username">catBot</a></strong> &raquo; </span>Tue May 12, 2015 2:52 pm
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>BUCKAROO wrote:</cite>.... No calls are being blocked, only the flags are sanitized...</div></blockquote>
Thank you - this is exactly what I dreamt of. Hope it will get into the official version of SB.<br>
<br>
I'm testing the library and be reporting ASAP.</div>

			
									
									<div id="sig109228" class="signature">winXP-SP3 hacked into POSReady2009.</div>
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p109236" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile109236">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="https://www.sandboxie.com/old-forums/memberlist08c3.html?mode=viewprofile&amp;u=5050" class="username">BUCKAROO</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search8ed68ed6.html?author_id=5050&amp;sr=posts">206</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Oct 24, 2010 3:13 am</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content109236">

						<h3 ><a href="#p109236">Re: SandBoxIE to harden SRP (software restriction policy)?</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="https://www.sandboxie.com/old-forums/posting45b9.html?mode=quote&amp;f=4&amp;p=109236" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author">
									<a class="unread" href="viewtopic0a690a69.html?p=109236#p109236" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="https://www.sandboxie.com/old-forums/memberlist08c3.html?mode=viewprofile&amp;u=5050" class="username">BUCKAROO</a></strong> &raquo; </span>Tue May 12, 2015 10:26 pm
			</p>
			
			
			
			<div class="content">Cool, catBot. Your test will be the first true test.<br>
<br>
Try a PoC that is if you want to receive ANY relevant output from DebugView (unless you're using the verbose OutputDebug\ dll).<br>
<br>
Just don't visit this <a href="viewtopic2ecb2ecb.php?f=17&amp;t=21113" class="postlink">other thread</a>, else feelings of despair could engulf you.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p109470" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile109470">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="https://www.sandboxie.com/old-forums/memberlist08c3.html?mode=viewprofile&amp;u=5050" class="username">BUCKAROO</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search8ed68ed6.html?author_id=5050&amp;sr=posts">206</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Oct 24, 2010 3:13 am</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content109470">

						<h3 ><a href="#p109470">Re: SandBoxIE to harden SRP (software restriction policy)?</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="https://www.sandboxie.com/old-forums/postingfcce-2.html?mode=quote&amp;f=4&amp;p=109470" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author">
									<a class="unread" href="viewtopicbf95bf95.html?p=109470#p109470" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="https://www.sandboxie.com/old-forums/memberlist08c3.html?mode=viewprofile&amp;u=5050" class="username">BUCKAROO</a></strong> &raquo; </span>Fri May 22, 2015 12:27 am
			</p>
			
			
			
			<div class="content"><span style="font-size: 85%; line-height: normal">What it does:<br>
Sanitizes SRP-breaking flags from...<br>
</span><ul>	<li>advapi32.CreateRestrictedToken<br>
	advapi32.SaferComputeTokenFromLevel<br>
	kernel32.LoadLibraryExW</li></ul>
What is new...<br>
kernel32.CreateProcessW
<ul>	<li>(good idea or bad - I mean, wrt Jobs)</li></ul>
What else, this version averts Sandboxie 4.x breach!
<ul>	<li>By blocking an undocumented function.<br>
	A function that XP does not export, so<br>
	does Vista?/7/8.x really need it either?!</li></ul>
Does not (will not) support:
<ul>	<li>ntdll.LdrLoadDll<br>
	kernelbase.LoadLibraryExW<br>
	but XP hasn't kernelbase.dll</li></ul>[/size]<div class="inline-attachment">
			
		
				<dl class="file">
			<dt class="attach-image"><img src="download/filece9ece9e.png?id=294" class="postimage" alt="SbieSRPx_20150522.png" onclick="viewableArea(this);" /></dt>
						<dd>SbieSRPx_20150522.png (20.96 KiB) Viewed 1453 times</dd>
		</dl>
		
		
		
			</div>
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>; Toggle build architecture
PtrSize fix 4 ; 32-bit
;PtrSize fix 8 ; 64-bit

; Toggle
;OutputDebug equ 0
OutputDebug equ 1

PtrSizeAsc='0'+PtrSize
SbieSRP_dll equ 'SbieSRP',PtrSizeAsc,'.dll'

match =4,PtrSize{format PE GUI 4.0 DLL}
match =8,PtrSize{format PE64 GUI 5.0 DLL}
entry DllEntryPoint

match =4,PtrSize{include 'WIN32WXP.INC'}
match =8,PtrSize{include 'WIN64WXP.INC'}

; BUCKAROO's trivial customization to fasmw17139\INCLUDE\MACRO\*
; Macroinstructions for making import section (32-bit or 64-bit)

macro import name,[label,string]
{
common
	if PtrSize=4
		rb (- rva $) and 3
	else if PtrSize=8
		rb (- rva $) and 7
	end if
	if defined name#.referred
name#.lookup:
forward
		if used label
			if string eqtype ''
				local _label
				if PtrSize=4
					dd RVA _label
				else if PtrSize=8
					dq RVA _label
				end if
			else
				if PtrSize=4
					dd 80000000h + string
				else if PtrSize=8
					dq 8000000000000000h + string
				end if
			end if
		end if
common
		if $ &gt; name#.lookup
			name#.redundant = 0
			if PtrSize=4
				dd 0
			else if PtrSize=8
				dq 0
			end if
		else
			name#.redundant = 1
		end if
name#.address:
forward
		if used label
			if string eqtype ''
				if PtrSize=4
					label dd RVA _label
				else if PtrSize=8
					label dq RVA _label
				end if
			else
				if PtrSize=4
					label dd 80000000h + string
				else if PtrSize=8
					label dq 8000000000000000h + string
				end if
			end if
		end if
common
		if ~ name#.redundant
			if PtrSize=4
				dd 0
			else if PtrSize=8
				dq 0
			end if
		end if
forward
		if used label &amp; string eqtype ''
			_label dw 0
label#.ansi:
			db string,0
			rb RVA $ and 1
		end if
common
	end if
}

match =4,PtrSize
{
dbz equ dd
tax equ eax
tcx equ ecx
tdx equ edx
}
match =8,PtrSize
{
dbz equ dq
tax equ rax
tcx equ rcx
tdx equ rdx
;
;tcx equ r10
;tdx equ r11
}

macro mioli op1*
{
	mov op1,tax
}

macro sioli op1*
{
	mov tax,op1
}

macro tioli
{
	test tax,tax
}

struc UNICODE_STRING
{
	.Length dw ?
	.MaximumLength dw ?
if PtrSize=8
rb 4
end if
	.Buffer dbz ?
}
virtual at 0
UNICODE_STRING UNICODE_STRING
end virtual

macro m_lp [m]
{
	m dbz ?
}

struc ntdll_
{
	m_lp .LdrLoadDll,.NtGetNextProcess
}

struc kernel32_
{
	m_lp .CreateProcessW,.LoadLibraryExW
}

struc kernelbase_
{
	m_lp .LoadLibraryExW
}

struc advapi32_
{
	m_lp .CreateRestrictedToken,.SaferComputeTokenFromLevel
}

struc SbieApi_
{
	m_lp .EnumProcessEx,.QueryProcess
}

struc SbieDll_
{
	m_lp .Hook
}

struc SbieDll_dll_
{
	.SbieApi_EnumProcessEx db 'SbieApi_EnumProcessEx',0
	.SbieApi_QueryProcess db 'SbieApi_QueryProcess',0
	.SbieDll_Hook db 'SbieDll_Hook',0
}

!LOAD_IGNORE_CODE_AUTHZ_LEVEL=not 0x10
!SANDBOX_INERT=not 0x2
!SAFER_TOKEN_MAKE_INERT=not 0x4

!CREATE_BREAKAWAY_FROM_JOB=not 0x1000000

section '.data' data readable writeable

;[pid]
; SbieSRPx: [session_id][box_name] "image_name" ProcName (flags was flags) "FileName" CommandLine

szDbgInfoFmt du '%hs: %ls%hs',10,0
szDbgHookFmt du '%hs: [%d][%ls] "%ls" %hs (0x%X was 0x%X) "%ls" %ls',10,0

szSbieSRP db 'SbieSRP',PtrSizeAsc,0

ntdll_dll db 'ntdll.dll',0
NtGetNextProcess.ansi db 'NtGetNextProcess',0

kernel32_dll db 'kernel32.dll',0
kernelbase_dll db 'kernelbase.dll',0
LoadLibraryExW.ansi db 'LoadLibraryExW',0

align 16

process_id dbz ?

struc _ProcessQuery
{
	.box_name rw 34
	.image_name rw 96
	.sid_string rw 96
	.session_id dd ?
}
HithertoProcess _ProcessQuery

ntdll ntdll_
kernel32 kernel32_
kernelbase kernelbase_
advapi32 advapi32_
SbieApi SbieApi_
SbieDll SbieDll_

SbieDll_dll SbieDll_dll_

section '.text' code executable readable

proc DllEntryPoint hinstDLL,fdwReason,lpvReserved
if PtrSize=8
	mov [hinstDLL],rcx
	mov [fdwReason],rdx
end if
	cmp [fdwReason],DLL_PROCESS_ATTACH
	je DLL_PROCESS_ATTACH_DllEntryPoint
	cmp [fdwReason],DLL_PROCESS_DETACH
	je DLL_PROCESS_DETACH_DllEntryPoint
	match =1,OutputDebug{stdcall OutputDebugText,'DllEntryPoint',NULL,NULL,NULL,NULL,NULL}
	jmp @f
DLL_PROCESS_ATTACH_DllEntryPoint:
	match =1,OutputDebug{stdcall OutputDebugText,'DLL_PROCESS_ATTACH',NULL,NULL,NULL,NULL,NULL}
	invoke DisableThreadLibraryCalls,[hinstDLL]
	jmp @f
DLL_PROCESS_DETACH_DllEntryPoint:
	match =1,OutputDebug{stdcall OutputDebugText,'DLL_PROCESS_DETACH',NULL,NULL,NULL,NULL,NULL}
	jmp @f
@@:
	sioli TRUE
	ret
endp

proc detour_LoadLibraryExW lpFileName,hFile,dwFlags
locals
	match =4,PtrSize{dwFlagsOld dd ?}
	match =8,PtrSize{dwFlagsOld dq ?}
endl
if PtrSize=8
	mov [lpFileName],rcx
	mov [hFile],rdx
	mov [dwFlags],r8
end if
	mov tax,[dwFlags]
	mov [dwFlagsOld],tax
	and [dwFlags],!LOAD_IGNORE_CODE_AUTHZ_LEVEL
match =0,OutputDebug
{
	cmp [dwFlags],tax
	je @f
}
	stdcall OutputDebugText,NULL,LoadLibraryExW.ansi,[lpFileName],NULL,[dwFlags],[dwFlagsOld]
@@:
	invoke kernel32.LoadLibraryExW,[lpFileName],[hFile],[dwFlags]
	;invoke kernelbase.LoadLibraryExW,[lpFileName],[hFile],[dwFlags]
	ret
endp

proc detour_6_2_LdrLoadDll dwFlags,SearchPathForFile,lpFileNameUnicodeString,hModule
locals
	match =4,PtrSize{dwFlagsOld dd ?}
	match =8,PtrSize{dwFlagsOld dq ?}
endl
if PtrSize=8
	mov [dwFlags],rcx
	mov [SearchPathForFile],rdx
	mov [lpFileNameUnicodeString],r8
	mov [hModule],r9
end if
	mov tax,[dwFlags]
	mov [dwFlagsOld],tax
	and [dwFlags],!LOAD_IGNORE_CODE_AUTHZ_LEVEL
match =0,OutputDebug
{
	cmp [dwFlags],tax
	je @f
}
	mov tdx,[lpFileNameUnicodeString]
	cmp tdx,NULL
	je @f
	;xor tax,tax
	xor tcx,tcx
	mov ax,[tdx+UNICODE_STRING.MaximumLength]
	mov cx,[tdx+UNICODE_STRING.Length]
	sub ax,cx
	cmp ax,2
	jnae @f
	mov tdx,[lpFileNameUnicodeString]
	mov tdx,[tdx+UNICODE_STRING.Buffer]
	cmp word [tdx+tcx],NULL
	jne @f
	stdcall OutputDebugText,NULL,LdrLoadDll.ansi,tdx,NULL,[dwFlags],[dwFlagsOld]
@@:
	invoke ntdll.LdrLoadDll,[dwFlags],[SearchPathForFile],[lpFileNameUnicodeString],[hModule]
	ret
endp

; Incorrect prototype - Was a work-in-process, was...
proc detour_5_0_LdrLoadDll SearchPathForFile,dwFlags,lpFileNameUnicodeString,hModule
locals
	match =4,PtrSize{dwFlagsOld dd ?}
	match =8,PtrSize{dwFlagsOld dq ?}
endl
if PtrSize=8
	mov [SearchPathForFile],rcx
	mov [dwFlags],rdx
	mov [lpFileNameUnicodeString],r8
	mov [hModule],r9
end if
	mov tax,[dwFlags]
	mov [dwFlagsOld],tax
	and [dwFlags],!LOAD_IGNORE_CODE_AUTHZ_LEVEL
match =0,OutputDebug
{
	cmp [dwFlags],tax
	je @f
}
	;
@@:
	invoke ntdll.LdrLoadDll,[SearchPathForFile],[dwFlags],[lpFileNameUnicodeString],[hModule]
	ret
endp

proc detour_CreateRestrictedToken ExistingTokenHandle,Flags,DisableSidCount,SidsToDisable,DeletePrivilegeCount,PrivilegesToDelete,RestrictedSidCount,SidsToRestrict,NewTokenHandle
locals
	match =4,PtrSize{FlagsOld dd ?}
	match =8,PtrSize{FlagsOld dq ?}
endl
if PtrSize=8
	mov [ExistingTokenHandle],rcx
	mov [Flags],rdx
	mov [DisableSidCount],r8
	mov [SidsToDisable],r9
end if
	mov tax,[Flags]
	mov [FlagsOld],tax
	and [Flags],!SANDBOX_INERT
match =0,OutputDebug
{
	cmp [Flags],tax
	je @f
}
	stdcall OutputDebugText,NULL,CreateRestrictedToken.ansi,NULL,NULL,[Flags],[FlagsOld]
@@:
	invoke advapi32.CreateRestrictedToken,[ExistingTokenHandle],[Flags],[DisableSidCount],[SidsToDisable],[DeletePrivilegeCount],[PrivilegesToDelete],[RestrictedSidCount],[SidsToRestrict],[NewTokenHandle]
	ret
endp

proc detour_SaferComputeTokenFromLevel LevelHandle,InAccessToken,OutAccessToken,dwFlags,lpReserved
locals
	match =4,PtrSize{dwFlagsOld dd ?}
	match =8,PtrSize{dwFlagsOld dq ?}
endl
if PtrSize=8
	mov [LevelHandle],rcx
	mov [InAccessToken],rdx
	mov [OutAccessToken],r8
	mov [dwFlags],r9
end if
	mov tax,[dwFlags]
	mov [dwFlagsOld],tax
	and [dwFlags],!SAFER_TOKEN_MAKE_INERT
match =0,OutputDebug
{
	cmp [dwFlags],tax
	je @f
}
	stdcall OutputDebugText,NULL,SaferComputeTokenFromLevel.ansi,NULL,NULL,[dwFlags],[dwFlagsOld]
@@:
	invoke advapi32.SaferComputeTokenFromLevel,[LevelHandle],[InAccessToken],[OutAccessToken],[dwFlags],[lpReserved]
	ret
endp

proc detour_CreateProcessW lpApplicationName,lpCommandLine,lpProcessAttributes,lpThreadAttributes,bInheritHandles,dwCreationFlags,lpEnvironment,lpCurrentDirectory,lpStartupInfo,lpProcessInformation
locals
	match =4,PtrSize{dwCreationFlagsOld dd ?}
	match =8,PtrSize{dwCreationFlagsOld dq ?}
endl
if PtrSize=8
	mov [lpApplicationName],rcx
	mov [lpCommandLine],rdx
	mov [lpProcessAttributes],r8
	mov [lpThreadAttributes],r9
end if
	mov tax,[dwCreationFlags]
	mov [dwCreationFlagsOld],tax
	and [dwCreationFlags],!CREATE_BREAKAWAY_FROM_JOB
match =0,OutputDebug
{
	cmp [dwCreationFlags],tax
	je @f
}
	stdcall OutputDebugText,NULL,CreateProcessW.ansi,[lpApplicationName],[lpCommandLine],[dwCreationFlags],[dwCreationFlagsOld]
@@:
	invoke kernel32.CreateProcessW,[lpApplicationName],[lpCommandLine],[lpProcessAttributes],[lpThreadAttributes],[bInheritHandles],[dwCreationFlags],[lpEnvironment],[lpCurrentDirectory],[lpStartupInfo],[lpProcessInformation]
	ret
endp

proc detour_NtGetNextProcess ProcessHandle,DesiredAccess,HandleAttributes,Flags,NewProcessHandle
	stdcall OutputDebugText,'Dodged ',NtGetNextProcess.ansi,NULL,NULL,NULL,NULL
	sioli 0x8000001A ; STATUS_NO_MORE_ENTRIES
	ret
endp

proc OutputDebugText szInfo,lpProcName,sz1,sz2,dwFlagsNew,dwFlagsOld
locals
	match =4,PtrSize{lpOut dd ?}
	match =8,PtrSize{lpOut dq ?}
endl
if PtrSize=8
	mov [szInfo],rcx
	mov [lpProcName],rdx
	mov [sz1],r8
	mov [sz2],r9
end if
	invoke VirtualAlloc,NULL,2050,MEM_COMMIT+MEM_RESERVE,PAGE_READWRITE
	mioli [lpOut]
	tioli
	jz fail_OutputDebugText
	cmp [szInfo],NULL
	je @f
	cinvoke wsprintfW,[lpOut],szDbgInfoFmt,szSbieSRP,[szInfo],[lpProcName]
	jmp pass_OutputDebugText
@@:
	cinvoke wsprintfW,[lpOut],szDbgHookFmt,szSbieSRP,[HithertoProcess.session_id],HithertoProcess.box_name,HithertoProcess.image_name,[lpProcName],[dwFlagsNew],[dwFlagsOld],[sz1],[sz2]
pass_OutputDebugText:
	invoke OutputDebugStringW,[lpOut]
	invoke VirtualFree,[lpOut],0,MEM_RELEASE
fail_OutputDebugText:
	ret
endp

proc InjectDllMain hSbieDll,UnusedParameter
if PtrSize=8
	mov [hSbieDll],rcx
end if
	match =1,OutputDebug{stdcall OutputDebugText,'InjectDllMain',NULL,NULL,NULL,NULL,NULL}
	
	invoke GetProcAddress,[hSbieDll],SbieDll_dll.SbieDll_Hook
	mioli [SbieDll.Hook]
	tioli
	jz fail_InjectDllMain
	invoke GetProcAddress,[hSbieDll],SbieDll_dll.SbieApi_QueryProcess
	mioli [SbieApi.QueryProcess]
	tioli
	jz fail_InjectDllMain
	invoke GetProcAddress,[hSbieDll],SbieDll_dll.SbieApi_EnumProcessEx
	mioli [SbieApi.EnumProcessEx]
	tioli
	jz fail_InjectDllMain
	invoke GetCurrentProcessId
	mioli [process_id]
	invoke SbieApi.QueryProcess,[process_id],HithertoProcess.box_name,HithertoProcess.image_name,HithertoProcess.sid_string,HithertoProcess.session_id
	tioli
	jnz fail_InjectDllMain
	
	; TODO workaround __COMPAT_LAYER
;	invoke GetVersion
	; IsWindows8OrGreater
;	cmp al,6
;	jnae @f
;	cmp ah,2
;	jnae @f
;stdcall OutputDebugText,'6.2',NULL,NULL,NULL,NULL,NULL
;	invoke SbieDll.Hook,LdrLoadDll.ansi,[LdrLoadDll],detour_6_2_LdrLoadDll
;	mioli [ntdll.LdrLoadDll]
;	jmp past_LdrLoadDll_InjectDllMain
@@:
;stdcall OutputDebugText,'5.0',NULL,NULL,NULL,NULL,NULL
;	invoke SbieDll.Hook,LdrLoadDll.ansi,[LdrLoadDll],detour_5_0_LdrLoadDll
;	mioli [ntdll.LdrLoadDll]
	
past_LdrLoadDll_InjectDllMain:

	; advapi32.CreateRestrictedToken
	invoke SbieDll.Hook,CreateRestrictedToken.ansi,[CreateRestrictedToken],detour_CreateRestrictedToken
	mioli [advapi32.CreateRestrictedToken]
	
	; advapi32.SaferComputeTokenFromLevel
	invoke SbieDll.Hook,SaferComputeTokenFromLevel.ansi,[SaferComputeTokenFromLevel],detour_SaferComputeTokenFromLevel
	mioli [advapi32.SaferComputeTokenFromLevel]
	
	; kernel32.CreateProcessW
	invoke SbieDll.Hook,CreateProcessW.ansi,[CreateProcessW],detour_CreateProcessW
	mioli [kernel32.CreateProcessW]
	
@@:
	; kernelbase.LoadLibraryExW
	invoke GetModuleHandleA,kernelbase_dll
	invoke GetProcAddress,tax,LoadLibraryExW.ansi
	tioli
	jz @f
;	invoke SbieDll.Hook,LoadLibraryExW.ansi,tax,detour_LoadLibraryExW
;	mioli [kernelbase.LoadLibraryExW]
	
@@:
	; kernel32.LoadLibraryExW
	invoke GetModuleHandleA,kernel32_dll
	invoke GetProcAddress,tax,LoadLibraryExW.ansi
	tioli
	jz @f
	invoke SbieDll.Hook,LoadLibraryExW.ansi,tax,detour_LoadLibraryExW
	mioli [kernel32.LoadLibraryExW]
	
@@:
	; ntdll.NtGetNextProcess
	invoke GetModuleHandleA,ntdll_dll
	invoke GetProcAddress,tax,NtGetNextProcess.ansi
	tioli
	jz @f
	invoke SbieDll.Hook,NtGetNextProcess.ansi,tax,detour_NtGetNextProcess
	mioli [ntdll.NtGetNextProcess]
	
@@:
	match =1,OutputDebug{stdcall OutputDebugText,'Inject stage passed.',NULL,NULL,NULL,NULL,NULL}
	ret
fail_InjectDllMain:
	stdcall OutputDebugText,'Inject stage failed.',NULL,NULL,NULL,NULL,NULL
	ret
endp

section '.idata' data readable import
library ntdll_dll,'ntdll.dll',kernel32_dll,'kernel32.dll',advapi32_dll,'advapi32.dll',user32_dll,'user32.dll'

import ntdll_dll,\
LdrLoadDll,'LdrLoadDll'

import kernel32_dll,\
CreateProcessW,'CreateProcessW',\
DisableThreadLibraryCalls,'DisableThreadLibraryCalls',GetCurrentProcessId,'GetCurrentProcessId',\
GetModuleHandleA,'GetModuleHandleA',GetProcAddress,'GetProcAddress',GetProcessId,'GetProcessId',\
OutputDebugStringW,'OutputDebugStringW',\
VirtualAlloc,'VirtualAlloc',VirtualFree,'VirtualFree'

import advapi32_dll,\
CreateRestrictedToken,'CreateRestrictedToken',SaferComputeTokenFromLevel,'SaferComputeTokenFromLevel'

import user32_dll,\
wsprintfW,'wsprintfW' ;,wvsprintfW,'wvsprintfW'

section '.edata' data readable export
export SbieSRP_dll,InjectDllMain,'InjectDllMain'

section '.reloc' data discardable readable fixups

postpone
{
display '@',10
display ':: INSTALL FROM AN ELEVATED COMMAND PROMPT',10
display 'COPY /B /Y "SbieSRP.dll" "%CommonProgramFiles%\',SbieSRP_dll,'"',10
display '@',10
display 'ATTRIB +R "%CommonProgramFiles%\',SbieSRP_dll,'"',10
display '@',10
display 'SET "Sbie=%ProgramFiles%\Sandboxie"',10
display 'SET "SbieIni="%Sbie%\SbieIni.exe""',10
display '%SbieIni% append GlobalSettings InjectDll "%CommonProgramFiles%\SbieSRP4.dll"',10
display '%SbieIni% append GlobalSettings InjectDll64 "%CommonProgramFiles%\SbieSRP8.dll"',10
display '@'
}
</code></pre></div>
Am not providing support, consider the project abandoned.</div>

							<dl class="attachbox">
					<dt>
						Attachments
					</dt>
											<dd>
			
		
		
				<dl class="file">
			<dt><span class="imageset icon_topic_attach"></span> <a class="postlink" href="download/file408e408e.php?id=295">SbieSRPx_20150522.zip</a></dt>
			<dd><em>SbieSRP4.dll<br />SbieSRP8.dll<br />VerboseOutput\SbieSRP4.dll<br />VerboseOutput\SbieSRP8.dll</em></dd>			<dd>(6.38 KiB) Downloaded 231 times</dd>
		</dl>
		
		
			</dd>
									</dl>
			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p109766" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile109766">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="https://www.sandboxie.com/old-forums/memberlist08c3.html?mode=viewprofile&amp;u=5050" class="username">BUCKAROO</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search8ed68ed6.html?author_id=5050&amp;sr=posts">206</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Oct 24, 2010 3:13 am</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content109766">

						<h3 ><a href="#p109766">Re: SandBoxIE to harden SRP (software restriction policy)?</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="https://www.sandboxie.com/old-forums/postinge768.html?mode=quote&amp;f=4&amp;p=109766" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author">
									<a class="unread" href="viewtopice466-2e466.html?p=109766#p109766" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="https://www.sandboxie.com/old-forums/memberlist08c3.html?mode=viewprofile&amp;u=5050" class="username">BUCKAROO</a></strong> &raquo; </span>Wed Jun 03, 2015 12:22 am
			</p>
			
			
			
			<div class="content">Sorry, catBot, I tested my dll and XP with SRP, for me this combination is not currently working. After SRP is taken off Unrestricted level, new Sandboxed processes quit pretty soon after they run.<br>
<br>
Interestingly and fortunately enough though...<br>
Sandboxie 4.02+ does (all?) what you proposed.<br>
Sandboxie 4.x mitigates this <a href="http://blog.didierstevens.com/2011/01/25/circumventing-srp-and-applocker-to-create-a-new-process-by-design/" class="postlink">Proof of Concept</a>;<br>
"blocked by group policy" where 3.76 does not.<br>
<br>
Other cautions - It comes with a free frogurt!<br>
The new 4.x hull breach is of great concern...<br>
My dll hotfix may freeze an offending program,<br>
an effective block, but yeah, infinite loop...<br>
but at least it can catch the call, the call -<br>
only - exploits could harbour the hooked code.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p114823" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile114823">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="https://www.sandboxie.com/old-forums/memberlist6c62.html?mode=viewprofile&amp;u=21971" class="username">marzametal</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search46854685.html?author_id=21971&amp;sr=posts">13</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Tue Mar 18, 2014 1:20 am</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content114823">

						<h3 ><a href="#p114823">Re: SandBoxIE to harden SRP (software restriction policy)?</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="https://www.sandboxie.com/old-forums/postinga7e9-2.html?mode=quote&amp;f=4&amp;p=114823" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author">
									<a class="unread" href="viewtopic70757075.html?p=114823#p114823" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="https://www.sandboxie.com/old-forums/memberlist6c62.html?mode=viewprofile&amp;u=21971" class="username">marzametal</a></strong> &raquo; </span>Sun Oct 18, 2015 4:18 am
			</p>
			
			
			
			<div class="content">Is this project still working, or active at all? I read it works for Vista x64... any chance it can be done for W7HP x64? The game might've changed a lot since v5 is now out...<br>
<br>
By the way, thanks for recommending setting the DLLs to read only... I am using Block Process Access, so their DLLs are now read only...<br>
<br>
Thanks for any replies to my query on this SRP topic...</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p114827" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile114827">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="https://www.sandboxie.com/old-forums/memberlist08c3.html?mode=viewprofile&amp;u=5050" class="username">BUCKAROO</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search8ed68ed6.html?author_id=5050&amp;sr=posts">206</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Oct 24, 2010 3:13 am</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content114827">

						<h3 ><a href="#p114827">Re: SandBoxIE to harden SRP (software restriction policy)?</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="https://www.sandboxie.com/old-forums/posting294d.html?mode=quote&amp;f=4&amp;p=114827" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author">
									<a class="unread" href="viewtopic97b397b3.html?p=114827#p114827" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="https://www.sandboxie.com/old-forums/memberlist08c3.html?mode=viewprofile&amp;u=5050" class="username">BUCKAROO</a></strong> &raquo; </span>Sun Oct 18, 2015 6:14 am
			</p>
			
			
			
			<div class="content">I can't recall what degree of success I had with my SbieSRP enforcement dll while actually supervised by SRP - I had no business working on it if I wasn't using SRP myself - it was just a code exercise to me.<br>
<br>
If you see debug output, it's functioning so much as it ever did.<br>
<br>
What you now face, "Software Restriction Policies (SRP) is Group Policy-based feature", and, Group Policy Editor is omitted from (7) Home Premium.<br>
<br>
Your best hope was PGS - Pretty Good Security, an alternative UI, but the hosting website was let go. If I had the time, I'd code something killer - never, never.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="https://www.sandboxie.com/old-forums/posting2758.html?mode=reply&amp;f=4&amp;t=19811" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic9cb39cb3.html?f=4&amp;t=19811&amp;start=30&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://forums.sandboxie.com/phpBB3/viewtopic.php?f=4&amp;t=19811&amp;start=30">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			37 posts
							<ul>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopic88a588a5.html?f=4&amp;t=19811&amp;start=15" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopicd6a9d6a9.html?f=4&amp;t=19811" role="button">1</a></li>
				<li><a class="button" href="viewtopic88a588a5.html?f=4&amp;t=19811&amp;start=15" role="button">2</a></li>
			<li class="active"><span>3</span></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum31e631e6.html?f=4" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “Feature Requests”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum907f907f.html?f=42" class="jumpbox-cat-link"> <span> Sandboxie Forums</span></a></li>
																<li><a href="viewforum12a312a3.html?f=2" class="jumpbox-sub-link"><span class="spacer"></span> <span> &#8627; &nbsp; Announcements</span></a></li>
																<li><a href="viewforumcf19cf19.html?f=6" class="jumpbox-sub-link"><span class="spacer"></span> <span> &#8627; &nbsp; Positive Reviews</span></a></li>
																<li><a href="viewforum107e107e.html?f=43" class="jumpbox-cat-link"> <span> Problems and Questions</span></a></li>
																<li><a href="viewforum8a838a83.html?f=11" class="jumpbox-sub-link"><span class="spacer"></span> <span> &#8627; &nbsp; Problem Reports</span></a></li>
																<li><a href="viewforum48ab48ab.html?f=17" class="jumpbox-sub-link"><span class="spacer"></span> <span> &#8627; &nbsp; Quick Questions</span></a></li>
																<li><a href="viewforumbcb4bcb4.html?f=65" class="jumpbox-sub-link"><span class="spacer"></span> <span> &#8627; &nbsp; Beta Version 5.25</span></a></li>
																<li><a href="viewforumab78ab78.html?f=44" class="jumpbox-cat-link"> <span> More Forums</span></a></li>
																<li><a href="viewforum31e631e6.html?f=4" class="jumpbox-sub-link"><span class="spacer"></span> <span> &#8627; &nbsp; Feature Requests</span></a></li>
																<li><a href="viewforume774e774.html?f=5" class="jumpbox-sub-link"><span class="spacer"></span> <span> &#8627; &nbsp; Anything Else</span></a></li>
																<li><a href="viewforum89418941.html?f=22" class="jumpbox-sub-link"><span class="spacer"></span> <span> &#8627; &nbsp; Contributed Utilities &amp; Templates</span></a></li>
																<li><a href="viewforum97809780.html?f=14" class="jumpbox-sub-link"><span class="spacer"></span> <span> &#8627; &nbsp; International Translations</span></a></li>
																<li><a href="viewforum2b892b89.html?f=38" class="jumpbox-sub-link"><span class="spacer"></span><span class="spacer"></span> <span> &#8627; &nbsp; Beta Version 4.01</span></a></li>
																<li><a href="viewforumdfa4dfa4.html?f=39" class="jumpbox-sub-link"><span class="spacer"></span><span class="spacer"></span> <span> &#8627; &nbsp; Beta Version 4.03</span></a></li>
																<li><a href="viewforuma3f5a3f5.html?f=40" class="jumpbox-sub-link"><span class="spacer"></span><span class="spacer"></span> <span> &#8627; &nbsp; Beta Version 4.05</span></a></li>
																<li><a href="viewforum51ee51ee.html?f=41" class="jumpbox-sub-link"><span class="spacer"></span><span class="spacer"></span> <span> &#8627; &nbsp; Beta Version 4.07</span></a></li>
																<li><a href="viewforum590b590b.html?f=46" class="jumpbox-sub-link"><span class="spacer"></span><span class="spacer"></span> <span> &#8627; &nbsp; Beta Version 4.09</span></a></li>
																<li><a href="viewforumcdbacdba.html?f=48" class="jumpbox-sub-link"><span class="spacer"></span><span class="spacer"></span> <span> &#8627; &nbsp; Beta Version 4.13</span></a></li>
																<li><a href="viewforum30ac30ac.html?f=49" class="jumpbox-sub-link"><span class="spacer"></span><span class="spacer"></span> <span> &#8627; &nbsp; Beta Version 4.15</span></a></li>
																<li><a href="viewforum91409140.html?f=50" class="jumpbox-sub-link"><span class="spacer"></span><span class="spacer"></span> <span> &#8627; &nbsp; Beta Version 4.17</span></a></li>
																<li><a href="viewforum208f208f.html?f=51" class="jumpbox-sub-link"><span class="spacer"></span><span class="spacer"></span> <span> &#8627; &nbsp; Beta Version 4.19</span></a></li>
																<li><a href="viewforum26492649.html?f=53" class="jumpbox-sub-link"><span class="spacer"></span><span class="spacer"></span> <span> &#8627; &nbsp; Beta Version 5.01</span></a></li>
																<li><a href="viewforum9e0d9e0d.html?f=54" class="jumpbox-sub-link"><span class="spacer"></span><span class="spacer"></span> <span> &#8627; &nbsp; Beta Version 5.05</span></a></li>
																<li><a href="viewforumfac0fac0.html?f=55" class="jumpbox-sub-link"><span class="spacer"></span><span class="spacer"></span> <span> &#8627; &nbsp; Beta Version 5.07</span></a></li>
																<li><a href="viewforuma05ca05c.html?f=56" class="jumpbox-sub-link"><span class="spacer"></span><span class="spacer"></span> <span> &#8627; &nbsp; Beta Version 5.09</span></a></li>
																<li><a href="viewforum6ac36ac3.html?f=57" class="jumpbox-sub-link"><span class="spacer"></span><span class="spacer"></span> <span> &#8627; &nbsp; Beta Version 5.11</span></a></li>
																<li><a href="viewforume57de57d.html?f=58" class="jumpbox-sub-link"><span class="spacer"></span><span class="spacer"></span> <span> &#8627; &nbsp; Beta Version 5.13</span></a></li>
																<li><a href="viewforum07560756.html?f=59" class="jumpbox-sub-link"><span class="spacer"></span><span class="spacer"></span> <span> &#8627; &nbsp; Beta Version 5.15</span></a></li>
																<li><a href="viewforumb8c1b8c1.html?f=60" class="jumpbox-sub-link"><span class="spacer"></span><span class="spacer"></span> <span> &#8627; &nbsp; Beta Version 5.17</span></a></li>
																<li><a href="viewforumdbf5dbf5.html?f=61" class="jumpbox-sub-link"><span class="spacer"></span><span class="spacer"></span> <span> &#8627; &nbsp; Beta Version 5.19</span></a></li>
																<li><a href="viewforum75c275c2.html?f=62" class="jumpbox-sub-link"><span class="spacer"></span><span class="spacer"></span> <span> &#8627; &nbsp; Beta Version 5.21</span></a></li>
																<li><a href="viewforume5f3e5f3.html?f=64" class="jumpbox-sub-link"><span class="spacer"></span><span class="spacer"></span> <span> &#8627; &nbsp; Beta Version 5.23</span></a></li>
											</ul>
		</div>
	</div>

	</div>

	<div class="stat-block online-list">
		<h3>Who is online</h3>
		<p>Users browsing this forum: No registered users and 0 guests</p>
	</div>

			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>Home</span></a></span>									<span class="crumb"><a href="index-2.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="America/New York">UTC-04:00</span></li>
							<li class="rightside">
				<a href="ucp033a033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="https://www.sandboxie.com/old-forums/memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="https://www.sandboxie.com/old-forums/memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron78d278d2.gif?cron_type=cron.task.core.tidy_sessions" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mince91ce91.js?assets_version=7"></script>
<script type="text/javascript" src="assets/javascript/corece91ce91.js?assets_version=7"></script>



<script type="text/javascript" src="styles/sbie_prosilver/template/forum_fnce91ce91.js?assets_version=7"></script>
<script type="text/javascript" src="styles/sbie_prosilver/template/ajaxce91ce91.js?assets_version=7"></script>



</body>

<!-- Mirrored from forums.sandboxie.com/phpBB3/viewtopic.php?p=109236 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 28 Mar 2020 08:46:16 GMT -->
</html>
