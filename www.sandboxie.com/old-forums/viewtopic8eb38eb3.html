<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forums.sandboxie.com/phpBB3/viewtopic.php?f=11&t=25633&start=30&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 28 Mar 2020 01:53:54 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>Sandboxie Support &bull; Microsoft Outlook 2016 launch problem - Sharepoint credentials/ One Drive - Page 3</title>

<link href="styles/sbie_prosilver/theme/print.css" rel="stylesheet">
</head>
<body id="phpbb">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>Sandboxie Support</h1>
		<p>Support Forum for Sandboxie<br /><a href="index.html">https://forums.sandboxie.com/phpBB3/</a></p>

		<h2>Microsoft Outlook 2016 launch problem - Sharepoint credentials/ One Drive</h2>
		<p><a href="viewtopic23a423a4.html?f=11&amp;t=25633">https://forums.sandboxie.com/phpBB3/viewtopic.php?f=11&amp;t=25633</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>3</strong> of <strong>3</strong></div>
					<div class="post">
				<h3>Re: Microsoft Outlook 2016 launch problem - Sharepoint credentials/ One Drive</h3>
				<div class="date">Posted: <strong>Mon Apr 16, 2018 1:00 pm</strong></div>
				<div class="author">by <strong>Carl Colijn</strong></div>
				<div class="content">Reading the linked article, as a test I uninstalled Internet Explorer (from Windows Features): no more iexplore.exe processes got started, but the extra top-level window is still there and Outlook still hangs...  I reinstalled iexplore again because it'll probably break too many things not having it there.<br>
<br>
Under the SharePoint lists, calendars and RSS feeds tabs there is also nothing listed.  When going to File \ Office Account (the 'submenu' option above "Feedback"), there are two services listed under "Connected Services": one says "OneDrive - &lt;his school's name&gt;", the other "Sites - &lt;his school's name&gt;"; these represent both his problematic OneDrive and his school's SharePoint site.  There's no way to remove these services; I can only add new ones.  His school apparently has everything locked down pretty tight so the kids can't mess it up <img class="smilies" src="images/smilies/icon_smile.gif" width="15" height="15" alt=":)" title="Smile"><br>
<br>
When going in an unsandboxed Outlook to the "Manage rules and alerts" setting, then selecting the "Manage alerts" tab, and finally selecting the exchange account, Outlook locked up completely though, and after a wait of a minute or so a prompt appeared that there was "an error connecting to the OneDrive location" or such, after which dismissing it nothing further happened and Outlook was frozen...  Killing Outlook and doing it again, the 1-minute wait is still there, although it pulls through this time, but now there's graphical garbage under the "Actions" header.  Further evidence that OneDrive is linked in tighter to Outlook than you'd expect, and messing up the link breaks things.<br>
<br>
Uninstalling the problematic OneDrive for Business (groove.exe + possibly msosync.exe) is unfortunately not possible on this laptop.  It had the regular 'personal' OneDrive installed (onedrive.exe), but that one was configured correctly and caused no issues.  I already uninstalled it nonetheless during my trials to get OneDrive working, since logging in to his account on office.com in the browser and selecting "sync" from there under the OneDrive tab caused his school's business OneDrive account to get linked by his personal OneDrive, messing things up even further.  The remaining OneDrive for Business version is the one that's borked up, but that one is part of the default Office Pro install, and there is no way to alter the separate components to install/uninstall for that, since his school's IT locked the configuration (it's an all or nothing Office Pro install, and there's also only a Repair option and no Modify under programs &amp; features).  Killing all OneDrive-related processes from Task Manager (onedrive.exe, groove.exe and msysync.exe) and then starting Outlook again doesn't reload them, but Outlook under Sandboxie still misbehaves the same way.  Wrestling some more with his OneDrive I got a prompt to appear offering me to use and install the latest version of OneDrive, but that only installed the personal one again and linked his business account to that one.  The problematic OneDrive for Business was then still there asking for attention and Outlook still won't work, so still no fix.<br>
<br>
I think the conclusion for now is that Office has become too complex and that if something somewhere goes wrong it starts doing unexpected things and it all falls down like a house of cards...  I'll first let his school's IT department fix his OneDrive, and then let's hope this also magically fixes his hanging Outlook.  Continuing solving it like this is probably just a waste of your and my time...</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Microsoft Outlook 2016 launch problem - Sharepoint credentials/ One Drive</h3>
				<div class="date">Posted: <strong>Fri Apr 20, 2018 12:26 pm</strong></div>
				<div class="author">by <strong>Rmar</strong></div>
				<div class="content">Hello Barb<br>
<br>
I think that I have found a fix for the problem that I had launching Outlook 2016 in a sandbox.  I have given direct access to this registry key in the Sandbox settings for Outlook -<br>
<br>
<strong>HKEY_LOCAL_MACHINE\Software\Wow6432Node\Microsoft\Office\16.0<br>
</strong><br>
Outlook seems to launch and function okay with this addition.<br>
<br>
Regards</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Microsoft Outlook 2016 launch problem - Sharepoint credentials/ One Drive</h3>
				<div class="date">Posted: <strong>Fri Apr 20, 2018 1:10 pm</strong></div>
				<div class="author">by <strong>Barb@Invincea</strong></div>
				<div class="content">Hello Rmar ,<br>
<br>
Thanks for the update. <br>
<br>
I have made the devs aware. They re-reviewing the PML you sent before as we did not notice this block in the Resource Access Mon Logs, or PML in the past.<br>
<br>
Can you confirm that if you remove that entry, the old behavior comes back? <br>
And to clarify, this is for all of your Office applications, correct? (Not just Outlook) .<br>
<br>
Regards,<br>
Barb.-</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Microsoft Outlook 2016 launch problem - Sharepoint credentials/ One Drive</h3>
				<div class="date">Posted: <strong>Tue Apr 24, 2018 10:51 am</strong></div>
				<div class="author">by <strong>Rmar</strong></div>
				<div class="content">Hello Barb<br>
<br>
Having got Outlook 2016 to work with Sandboxie, I was able to look at the files that were loaded into the sandbox at Outlook's launch.  I could then establish which ones are needed to allow launch without hanging.  What I found was that this file seemed to be needed -<br>
<br>
<strong>%Local AppData%\Microsoft\Office\16.0\officec2rclient.exe_Rules.xml</strong><br>
<br>
I therefore gave it read access in the Sandbox settings.  I then removed the registry access that I had previously granted and Outlook continued to launch without hanging.  I do not know what connection there can be between the registry entry and the file and I do not have sufficient skill to find the connection.<br>
<br>
I have had less success with launching Word in a sandbox.  If I give read access to the file &lt;<strong>%Local AppData%\Microsoft\Office\16.0\officec2rclient.exe_Rules.xml</strong>&gt; in the sandbox settings, Word still hangs at launch.  I have not yet had time to try alternative settings, but I will try to do so during the next few days.<br>
<br>
Regards</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Microsoft Outlook 2016 launch problem - Sharepoint credentials/ One Drive</h3>
				<div class="date">Posted: <strong>Tue Apr 24, 2018 12:19 pm</strong></div>
				<div class="author">by <strong>Barb@Invincea</strong></div>
				<div class="content">Hello Rmar ,<br>
<br>
By default, Sandboxie has read access to your computer stuff (but it can't write to it unless explicitly set to do so). <br>
<br>
Unfortunately, I don't have enough information regarding the account or rules being used in order to test this on my end. I still cannot reproduce any of the issues listed in this thread. <br>
<br>
Have you tried disabling/uninstalling all your addins outside Sandboxie, and then launching Word/Outlook/Excel inside a new Sandbox with default settings? <br>
 <br>
Regards,<br>
Barb.-</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Microsoft Outlook 2016 launch problem - Sharepoint credentials/ One Drive</h3>
				<div class="date">Posted: <strong>Tue Apr 24, 2018 12:45 pm</strong></div>
				<div class="author">by <strong>Rmar</strong></div>
				<div class="content">Hello Barb<br>
<br>
Yes, I've tried deleting all the Outlook addons outside of the Sandbox and then launching the program in a fresh Sandbox with default settings.  I've tried completely uninstalling Office 2016 from my computer using the Microsoft cleanup utility and then re-installing.  I've tried a fresh install of Office 2016 on a different computer.  Always, I have the same problem with Outlook hanging at launch.  I'm not too bothered personally about the other Office apps because I don't generally feel any need to run them Sandboxed.  I've therefore concentrated most of my effort on Outlook.  For the moment, it seems that I am okay with Outlook provided that I allow access to the file I previously mentioned.  This is good enough for me and anything further is just curiosity and a lingering fear that the problem might return.<br>
<br>
It's strange that you cannot reproduce the issue.  I can only imagine that I have a different version of Office 2016 to yours.  My version is Office Professional Plus 2016 v.1803 (Build 9126.2152 Click to Run) x64.  All available updates are installed.<br>
<br>
Regards</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="America/New York">UTC-04:00</span><br />Page <strong>3</strong> of <strong>3</strong></div>
		<div class="copyright">Powered by phpBB&reg; Forum Software &copy; phpBB Limited<br />https://www.phpbb.com/</div>
	</div>
</div>

</body>

<!-- Mirrored from forums.sandboxie.com/phpBB3/viewtopic.php?f=11&t=25633&start=30&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 28 Mar 2020 01:53:54 GMT -->
</html>
