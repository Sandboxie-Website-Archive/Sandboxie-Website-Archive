<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forums.sandboxie.com/phpBB3/viewtopic.php?f=4&t=9617&start=15&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 28 Mar 2020 08:53:57 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>Sandboxie Support &bull; Freeze/Snapshot Sandbox Contents - Page 2</title>

<link href="styles/sbie_prosilver/theme/print.css" rel="stylesheet">
</head>
<body id="phpbb">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>Sandboxie Support</h1>
		<p>Support Forum for Sandboxie<br /><a href="index.html">https://forums.sandboxie.com/phpBB3/</a></p>

		<h2>Freeze/Snapshot Sandbox Contents</h2>
		<p><a href="viewtopiceed7-2eed7.html?f=4&amp;t=9617">https://forums.sandboxie.com/phpBB3/viewtopic.php?f=4&amp;t=9617</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>2</strong> of <strong>2</strong></div>
					<div class="post">
				<h3></h3>
				<div class="date">Posted: <strong>Mon Oct 03, 2011 9:20 am</strong></div>
				<div class="author">by <strong>shawndion</strong></div>
				<div class="content">Thank you everyone ... now here's the part where it's your job..<br>
<br>
I want to know exactly what you need from this tool... as of the Freeze, Backup, Restore, Save Changes, etc.<br>
Abuse of this suggestion... I'm available to work on this for a month..<br>
<br>
Keep me busy the less I think the more healty it is for me..<br>
<br>
Shawn<br>
<br>
P.S: I'm coding this all week I took a week off to get this done right...people need a tool to test and make a blacklist of softwares that cause more harm than good..<br>
<br>
P.P.S: Your condolences are welcomed it was the family priest the man thought me gambling and arcades hence my love of computers ... in a instance this man made me who I am today... so if this project works well at least I'll have the opportunity to make him proud..</div>
			</div>
			<hr />
					<div class="post">
				<h3></h3>
				<div class="date">Posted: <strong>Mon Oct 03, 2011 8:25 pm</strong></div>
				<div class="author">by <strong>D1G1T@L</strong></div>
				<div class="content"><blockquote class="uncited"><div>I want to know exactly what you need from this tool... as of the Freeze, Backup, Restore, Save Changes, etc. <br>
Abuse of this suggestion... I'm available to work on this for a month.. </div></blockquote>

Thats a good selection features you thought of there. I would really love to see them in your addon at some point, but I don't want to burden you especially in your state now. <br>
<br>
If you can accomplish the cloning functionality that would be great for a start. I can tell you that on this forum, your work will be appreciated and you will gather a following really quickly around here  <img class="smilies" src="images/smilies/icon_smile.gif" width="15" height="15" alt=":)" title="Smile"></div>
			</div>
			<hr />
					<div class="post">
				<h3></h3>
				<div class="date">Posted: <strong>Tue Oct 04, 2011 3:12 am</strong></div>
				<div class="author">by <strong>shawndion</strong></div>
				<div class="content">Hi DIGIT@L,<br>
                    Well in my case it's 3am right now and this is my dedication project. Part of the batch file will contain regdiff to make a patch registry (To go back and from a installation setting) the site is p-nand-q.com/download/regdiff.html (Reason why I'm posting the link is that the author is giving away a python script of his code)<br>
<br>
Play with it (Under Sandboxie even) the commands are amazing...<br>
<br>
As for the backup script I'm using FC to file compare folders and tskill,taskkill.. the next 3 days I'm tweaking it. The skeleton code is done it's just I want to make this OS specific and because not everyone installs their sandbox as a default I want to be able to have a "Set" configuration file people can modify for their need.<br>
<br>
And the reason is simple why I'm dedicating my time to this. Sandboxie is a amazing program that saved me already weeks of re-installations and tons of money (I use regdiff and sanboxie to make ultimate regclean tools) So the least I could do is help the community do the same.<br>
<br>
After this is done I'll concentrating on making a userguide as many people keep calling me for help on how to tweak sandboxie.<br>
<br>
I'll keep you all posted on the progrress as I seriously want to keep my mind off of things..<br>
<br>
Shawn.</div>
			</div>
			<hr />
					<div class="post">
				<h3></h3>
				<div class="date">Posted: <strong>Fri Oct 07, 2011 12:29 am</strong></div>
				<div class="author">by <strong>oloid</strong></div>
				<div class="content">Thanks for your efforts shawndion! Though you might not get a proper audience in this thread and this month I'm sure your work will be appreciated down the road. I look forward to testing and using your tools as I'd been planning to create some basic backup/restore batch files along with some pre-prepared 'base' sandboxes with specialized contents (mostly to do with different browsers and multiple configurations and different hosts files). Your scripts should offer greater sophistication and ease than I could have hoped for. That's all for now. God bless.</div>
			</div>
			<hr />
					<div class="post">
				<h3></h3>
				<div class="date">Posted: <strong>Fri Oct 07, 2011 5:50 am</strong></div>
				<div class="author">by <strong>shawndion</strong></div>
				<div class="content">Thought I wouldn't be able to pull it off this week but here are the batch files you need to work with.<br>
With some settings ajustments and I'll keep on working on them even make a autoit script soon..<br>
<br>
So here we go bare in mind this is setup for my DefaultBox but I'll be modifing it acording to everyone needs<br>
But I did want to have something functional for all to understand how it's done.<br>
<br>
First Batch file you need is the Initial Backup.<br>
<br>
-----------------------------------------------------------------<br>
Backup.bat<br>
-----------------------------------------------------------------<br>
:Backup<br>
taskkill /F /IM SbieCtrl.exe<br>
xcopy c:\Sandbox\%USERNAME%\DefaultBox\*.* c:\Original\Sanboxie\DefaultBox /e /i /h /y<br>
"C:\Program Files\Sandboxie\SbieCtrl.exe" /open<br>
-----------------------------------------------------------------<br>
<br>
Note: The taskkill program shut's the process of sandboxie so that you can unlock the reghive.<br>
Should there be a easier way to launch SB let me know<br>
<br>
-----------------------------------------------------------------<br>
BackupDiff.bat<br>
-----------------------------------------------------------------<br>
:BackupDiff<br>
taskkill /F /IM SbieCtrl.exe<br>
xcopy c:\Sandbox\%USERNAME%\DefaultBox\*.* c:\Modified\Sanboxie\DefaultBox /e /i /h /y<br>
"C:\Program Files\Sandboxie\SbieCtrl.exe" /open<br>
-----------------------------------------------------------------<br>
<br>
-----------------------------------------------------------------<br>
Restore.bat<br>
-----------------------------------------------------------------<br>
:Restore<br>
taskkill /F /IM SbieCtrl.exe<br>
rd /s /q c:\Sandbox\%USERNAME%\DefaultBox\<br>
xcopy c:\Original\Sanboxie\DefaultBox*.* c:\Sandbox\%USERNAME%\DefaultBox\  /e /i /h /y<br>
rem "C:\Program Files\Sandboxie\SbieCtrl.exe" /open<br>
-----------------------------------------------------------------<br>
<br>
Note: To restore a Original backup that you did. Warning this removes the DefaultBox folder<br>
before re-copying the files into it.<br>
<br>
-----------------------------------------------------------------<br>
sbtool.bat (This batch calls the others needed to run)<br>
-----------------------------------------------------------------<br>
@echo off<br>
REM ------------------------------------------------------------<br>
REM      Sandboxie Backup / Restore / What Has Changed Tool<br>
REM ------------------------------------------------------------<br>
<br>
Subst L: C:\Original\Sandboxie\DefaultBox<br>
Subst M: C:\Modified\Sandboxie\DefaultBox<br>
<br>
Call MakeFolders.bat<br>
Call OriginalCompare.bat<br>
Call ModifiedCompare.bat<br>
Call getreg.bat<br>
Subst L: /D<br>
Subst M: /D<br>
Echo Done...<br>
<br>
Pause<br>
<br>
-----------------------------------------------------------------<br>
MakeFolders.bat<br>
-----------------------------------------------------------------<br>
<br>
@echo off<br>
REM ------------------------------------------------------------<br>
REM      Sandboxie Backup / Restore / What Has Changed Tool<br>
REM ------------------------------------------------------------<br>
<br>
Set Original=L:<br>
Set Modified=M:<br>
<br>
dir /s /b /ad "%Modified%" &gt; C:\ModFolder.txt<br>
<br>
for /F "tokens=*" %%* in (c:\ModFolder.txt) do call :Foldersub %%*<br>
Goto :EOF<br>
<br>
:Foldersub<br>
Set Folder=%*<br>
Set Folder=%Folder:~3%<br>
Echo %Folder% &gt;&gt;C:\flist.txt<br>
MD "C:\Different\%Folder%"<br>
<br>
-----------------------------------------------------------------<br>
OriginalCompare.bat<br>
-----------------------------------------------------------------<br>
@echo off<br>
REM ------------------------------------------------------------<br>
REM      Sandboxie Backup / Restore / What Has Changed Tool<br>
REM ------------------------------------------------------------<br>
<br>
REM DEFINE YOUR OWN LETTERS HERE THESES ARE EXAMPLES<br>
<br>
Set Original=L:<br>
Set Modified=M:<br>
<br>
dir /a-d /s /b "%Original%" &gt; C:\Original.txt<br>
<br>
for /F "tokens=*" %%* in (c:\Original.txt) do call :Originalsub %%*<br>
Goto :EOF<br>
<br>
:Originalsub<br>
set One=%*<br>
set Two=%*<br>
set Two=%Modified%%Two:~2%<br>
set Three=%Two:~3%<br>
If EXIST "%Two%" fc /b "%One%" "%Two%" |find /i "no differences" &gt;Nul<br>
SET VALUE=%ERRORLEVEL%<br>
IF %VALUE% == 1 echo f |xcopy "%Two%" "C:\Different\%Three%" /H /Y /V &gt;Nul<br>
if NOT EXIST "%Two%" Echo The File located in %TWO% Has been deleted from Original Location. &gt;&gt; C:\DeletedList.txt<br>
<br>
-----------------------------------------------------------------<br>
<br>
<br>
-----------------------------------------------------------------<br>
ModifiedCompare.bat<br>
-----------------------------------------------------------------<br>
@Echo off<br>
REM ------------------------------------------------------------<br>
REM      Sandboxie Backup / Restore / What Has Changed Tool<br>
REM ------------------------------------------------------------<br>
<br>
REM DEFINE YOUR OWN LETTERS HERE THESES ARE EXAMPLES<br>
<br>
Set Original=L:<br>
Set Modified=M:<br>
<br>
dir /a-d /s /b "%Modified%" &gt; C:\Modified.txt<br>
<br>
for /F "tokens=*" %%* in (c:\Modified.txt) do call :Modifiedsub %%*<br>
Goto :EOF<br>
<br>
:Modifiedsub<br>
set One=%*<br>
set Two=%*<br>
set Two=%Original%%Two:~2%<br>
set Three=%Two:~3%<br>
If EXIST "%Two%" fc /b "%One%" "%Two%" |find /i "no differences" &gt;nul<br>
SET VALUE=%ERRORLEVEL%<br>
IF %VALUE% == 1 echo f |xcopy "%One%" "C:\Different\%Three%" /H /Y /V &gt;nul<br>
IF NOT EXIST "%Two%" echo f |xcopy "%One%" "C:\Different\%Three%" /H /Y /V &gt;Nul<br>
<br>
-----------------------------------------------------------------<br>
GetReg.bat (This will collect the registry changes and place them in a reg file for you)<br>
-----------------------------------------------------------------<br>
REM CHANGE Sandbox_Compaq_Owner_DefaultBox FOR YOUR SANDBOX MOUNTED LOCATION<br>
<br>
REG LOAD HKEY_USERS\Sandbox_Compaq_Owner_DefaultBox L:\RegHive<br>
REG EXPORT HKEY_USERS\Sandbox_Compaq_Owner_DefaultBox Original.reg<br>
REG UNLOAD HKEY_USERS\Sandbox_Compaq_Owner_DefaultBox<br>
REG LOAD HKEY_USERS\Sandbox_Compaq_Owner_DefaultBox M:\RegHive<br>
REG EXPORT HKEY_USERS\Sandbox_Compaq_Owner_DefaultBox Modified.reg<br>
REG UNLOAD HKEY_USERS\Sandbox_Compaq_Owner_DefaultBox<br>
<br>
REM REGDIFF can be downloaded at <a href="http://www.p-nand-q.com/download/regdiff.html" class="postlink">http://www.p-nand-q.com/download/regdiff.html</a><br>
regdiff modified.reg original.reg -d Changes.reg<br>
<br>
-=-=-=-=-=-=-=-=--=-=-=--=-=-=-=--=-=-=-=-=-=--<br>
<br>
I'll be merging all these batch files together over the weekend to make it easier to understand.<br>
I'll be documenting it but I wanted to post a preview version of the script.<br>
I'll be working on this all week-end to clean it up and make it more user friendly.<br>
Shawn</div>
			</div>
			<hr />
					<div class="post">
				<h3></h3>
				<div class="date">Posted: <strong>Fri Oct 07, 2011 9:44 am</strong></div>
				<div class="author">by <strong>oloid</strong></div>
				<div class="content">Looking good, but I need to mention that SbieCtrl.exe is the GUI and doesn't even need to run (<a href="../indexa72b.html?ConfigureMenu#shell" class="postlink">see shell options</a>), thus your taskkill command would not shut down a running sandbox.<br>
<br>
I suspect you should use a command like this instead:<br>
<br>
start /wait "C:\Program Files\Sandboxie\Start.exe" /box:TestBox /terminate<br>
<br>
See: <br>
<br>
<a href="../indexfb58-2.html?StartCommandLine" class="postlink">http://www.sandboxie.com/index.php?StartCommandLine</a> (stop)<br>
<br>
<a href="http://ss64.com/nt/start.html" class="postlink">http://ss64.com/nt/start.html</a> (/wait)<br>
<br>
<br>
Also, your batch skills are over my head but the doubled "set Two=" lines in :Modifiedsub and :Originalsub look like they might be a harmless copy/paste mistake. I dunno, you decide.<br>
<br>
I haven't used it and don't know it's limitations but I'm wondering if the SET command could be used to make customizing the batch files easier for the end user (though not for you). Imagining a set of  SETs at the top of the file to define box names and paths and <span style="text-decoration: underline">everything</span>.</div>
			</div>
			<hr />
					<div class="post">
				<h3></h3>
				<div class="date">Posted: <strong>Fri Oct 07, 2011 10:15 am</strong></div>
				<div class="author">by <strong>oloid</strong></div>
				<div class="content">Oops, please ignore me. Reviewing, I see you've <span style="text-decoration: underline">already stated</span> that you're preparing SET commands for easy customization.  Also, by only thinking along one track (processes running in a sandbox) I failed to remember that you'd <span style="text-decoration: underline">already stated</span> that closing SbieCtrl.exe (with taskkill) is needed to unlock the reghive. Even so, I suppose the "terminate" command would be good to run first as precaution. I'm sorry. I'm tired. Please don't take offense. I'll shut up now.</div>
			</div>
			<hr />
					<div class="post">
				<h3></h3>
				<div class="date">Posted: <strong>Fri Oct 07, 2011 3:07 pm</strong></div>
				<div class="author">by <strong>shawndion</strong></div>
				<div class="content">@oloid<br>
<br>
I'll fix up the taskkill to work better so no worries It's just that I was up for over 48 hours of insomnia so I didn't get a chance to document properly and with the proper SET commands and merging it all to one it will be easier to understand so don't worry about it..<br>
<br>
As for your question about the %Two% varablie I'll explain it now.<br>
<br>
set Two=%* <br>
set Two=%Modified%%Two:~2% <br>
<br>
The first Two grabs the Variable that beeing sent by the for loop call the second one what it does is that it deletes the first 2 characters (Ie: L: in this case) and replaces it with the drive letter of the Modified M:<br>
<br>
But don't worry about it I'll get it cleaned up and documented so that we all can improve on the code and have something we'll all enjoy.<br>
<br>
Shawn</div>
			</div>
			<hr />
					<div class="post">
				<h3></h3>
				<div class="date">Posted: <strong>Sun Oct 09, 2011 3:53 pm</strong></div>
				<div class="author">by <strong>shawndion</strong></div>
				<div class="content">Sorry for taking so long in regards to making it all in one file but I want this batch file to run with the least amount of user intervention.<br>
<br>
Pasted Bellow is a code that will grab the sandbox names and use them as a variable so that you don't have to type it in everytime you want to switch a sandbox to backup.<br>
<br>
But we're getting there I merged all the batches in one now I'm just optimizing it to get all the values so that you don't have to type them in.<br>
<br>
I'm also adding a Transpose Module (This will copy 1 sandbox to another great for MMORPG type of installations)<br>
<br>
The next step is a Sandboxie.ini Editor.<br>
Shawn<br>
<br>
Sample Output<br>
<br>
C:\WINDOWS&gt;test<br>
Sandbox Choices (Up to 20 Sandboxes)<br>
01.DefaultBox<br>
02.NetObjectsFusionX<br>
03.LineageII<br>
04.OnlineGameDownloader<br>
05.NoWebTest<br>
06.HelpMaker<br>
07.FireFox<br>
08.<br>
09.<br>
10.<br>
11.<br>
12.<br>
13.<br>
14.<br>
15.<br>
16.<br>
17.<br>
18.<br>
19.<br>
20.<br>
<br>
Code :<br>
@echo off<br>
set /a counter=0<br>
find "[" c:\Windows\Sandboxie.ini &gt;c:\report.txt<br>
find /V " " C:\report.txt &gt;c:\nospace.txt<br>
find /V "_" C:\nospace.txt &gt;c:\no_.txt<br>
find "[" c:\no_.txt &gt;c:\report.txt<br>
<br>
for /F "tokens=*" %%* in (c:\Report.txt) do call :Originalsub %%*<br>
goto :End<br>
<br>
:Originalsub<br>
set str=%*<br>
if "%str%"== "---------- C:\NO_.TXT" goto :eof<br>
if "%str%"== "[GlobalSettings]" goto :eof<br>
set /a counter+=1<br>
set str=%str:~1,-1%<br>
set Box%counter%=%str%<br>
goto :eof<br>
<br>
:End<br>
Echo Sandbox Choices (Up to 20 Sandboxes)<br>
<br>
Echo 01. %box1%<br>
Echo 02. %box2%<br>
Echo 03. %box3%<br>
Echo 04. %box4%<br>
Echo 05. %box5%<br>
Echo 06. %box6%<br>
Echo 07. %box7%<br>
Echo 08. %box8%<br>
Echo 09. %box9%<br>
Echo 10. %box10%<br>
Echo 11. %box11%<br>
Echo 12. %box12%<br>
Echo 13. %box13%<br>
Echo 14. %box14%<br>
Echo 15. %box15%<br>
Echo 16. %box16%<br>
Echo 17. %box17%<br>
Echo 18. %box18%<br>
Echo 19. %box19%<br>
Echo 20. %box20%</div>
			</div>
			<hr />
					<div class="post">
				<h3></h3>
				<div class="date">Posted: <strong>Mon Oct 10, 2011 4:15 am</strong></div>
				<div class="author">by <strong>tzuk</strong></div>
				<div class="content">Looks like you're making progress shawndion, nice.  To follow up on an earlier suggestion from D1G1T@L, I think you should post the documentation into a new topic in the Contributed Utilities forum, so that new forum can become the "home topic" for this utility.</div>
			</div>
			<hr />
					<div class="post">
				<h3>We're Moving to Contributed Utilities...</h3>
				<div class="date">Posted: <strong>Mon Oct 10, 2011 4:53 am</strong></div>
				<div class="author">by <strong>shawndion</strong></div>
				<div class="content">Join us at :<br>
<br>
<a href="../phpbb/viewtopic21d6.php?t=11644" class="postlink">http://www.sandboxie.com/phpbb/viewtopic.php?t=11644</a><br>
<br>
Shawn</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="America/New York">UTC-04:00</span><br />Page <strong>2</strong> of <strong>2</strong></div>
		<div class="copyright">Powered by phpBB&reg; Forum Software &copy; phpBB Limited<br />https://www.phpbb.com/</div>
	</div>
</div>

</body>

<!-- Mirrored from forums.sandboxie.com/phpBB3/viewtopic.php?f=4&t=9617&start=15&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 28 Mar 2020 08:53:57 GMT -->
</html>
